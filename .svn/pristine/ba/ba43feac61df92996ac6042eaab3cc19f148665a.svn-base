IF EXISTS (SELECT * FROM sysobjects WHERE type = 'P' AND name = 'UpdateWorkPermit')
BEGIN
    DROP  Procedure  UpdateWorkPermit
END

GO

CREATE PROCEDURE dbo.UpdateWorkPermit
(
    @Version varchar(10),
    @WorkPermitStatusId bigint,
    @FunctionalLocationId bigint,
    @PermitNumber varchar(50),
    @WorkOrderNumber varchar(50) = NULL,
    @SapOperationId char(8) = NULL,
    @StartDateTime datetime,
    @StartTimeNotApplicable bit,
    @EndDateTime datetime = null,
    @StartAndOrEndTimesFinalized BIT,
    @PermitValidDateTime datetime = NULL,
    @WorkPermitTypeId bigint,
    @WorkPermitTypeClassificationId bigint,
    @WorkOrderDescription VARCHAR(MAX) = NULL,
    @SpecialPrecautionsOrConsiderationsDescription text = NULL,
    @RevalidationDateTime datetime = NULL,
    @ExtensionDateTime datetime=NULL,
    @ExtensionRevalidationDateTime datetime=NULL,
    @ExtensionTimeIssuer datetime=NULL,
    @ExtensionTimeNonIssuer datetime=NULL,
    @ISSUER_SOURCEXTENSION VARCHAR(MAX) = NULL,
    @Revalidation   int=NULL,
    @Extension int=NULL,
    @ExtensionEnable bit,
    @RevalidationEnable bit, 
    @BeforeExtensionDateTime datetime=null, 
    @MidExtensionvalueIssuer datetime=null, 
    @MidExtensionvaluenonIssuer datetime=null,
    @PermitConfinedSpaceEntry bit,
    @PermitBreathingAirOrSCBA bit,
    @PermitElectricalWork bit,
    @PermitVehicleEntry bit,
    @PermitHotTap bit,
    @PermitBurnOrOpenFlame bit,
    @PermitSystemEntry bit,
    @PermitCriticalLift bit,
    @PermitExcavation bit,
    @PermitAsbestos bit,
    @PermitRadiationRadiography bit,
    @PermitRadiationSealed bit,
    @PermitInertConfinedSpaceEntry bit,
	@PermitFreshAir bit, --vibhor
	@ControlRoomContacted bit, --vibhor
    @PermitLeadAbatement bit,

    @AdditionalCSEAssessmentOrAuthorization bit,
    @AdditionalCSEAssessmentOrAuthorizationDescription varchar(50) = NULL,
    @AdditionalFlareEntry bit,
    @AdditionalCriticalLift bit,
    @AdditionalCriticalLiftDescription varchar(50) = NULL,
    @AdditionalExcavation bit,
    @AdditionalExcavationDescription varchar(50) = NULL,
    @AdditionalHotTap bit,
    @AdditionalSpecialWasteDisposal bit,
    @AdditionalBlankOrBlindLists bit,
    @AdditionalPJSROrSafetyPause bit,
    @AdditionalAsbestosHandling bit,
    @AdditionalAsbestosHandlingDescription varchar(50) = NULL,
    @AdditionalRoadClosure bit,
    @AdditionalElectrical bit,
    @AdditionalElectricalDescription varchar(50) = NULL,
    @AdditionalBurnOrOpenFlameAssessment bit,
    @AdditionalBurnOrOpenFlameAssessmentDescription varchar(50) = NULL,
    @AdditionalWaiverOrDeviation bit,
    @AdditionalWaiverOrDeviationDescription varchar(50) = NULL,
    @AdditionalMSDS bit,
    @AdditionalOtherFormsOrAssessmentsOrAuthorizations varchar(50) = NULL,
    @AdditionalRadiationApproval bit,
    @AdditionalOnlineLeakRepairForm bit,
	@AdditionalIsEnergizedElectricalForm bit,
	@AdditionalIsNotApplicable bit,

    @ContactPersonnel varchar(50) = NULL,
    @ContractorCompanyName varchar(50) = NULL,
    @CraftOrTradeID bigint = NULL,
    @CraftOrTradeOther varchar(50) = NULL,
    @JobStepDescription VARCHAR(MAX) = NULL,
    @CommunicationByRadio bit = NULL,
    @CommunicationRadioChannelOrBand varchar(20) = NULL,
    @IsWorkPermitCommunicationNotApplicable bit,
    @CommunicationRadioColor varchar(20) = NULL,
    @CommunicationByOtherDescription varchar(50) = NULL,
    @CoAuthorizationRequired bit = NULL,
    @CoAuthorizationDescription varchar(50) = NULL,

    @ToolsAirTools bit,
    @ToolsCraneOrCarrydeck bit,
    @ToolsHandTools bit,
    @ToolsJackhammer bit,
    @ToolsVacuumTruck bit,
    @ToolsCementSaw bit,
    @ToolsElectricTools bit,
    @ToolsHeavyEquipment bit,
    @ToolsLanda bit,
    @ToolsScaffolding bit,
    @ToolsVehicle bit,
    @ToolsCompressor bit,
    @ToolsForklift bit,
    @ToolsHEPAVacuum bit,
    @ToolsManlift bit,
    @ToolsTamper bit,
    @ToolsHotTapMachine bit,
    @ToolsPortLighting bit,
    @ToolsTorch bit,
    @ToolsWelder bit,
    @ToolsChemicals bit,
    @ToolsOtherToolsDescription varchar(50) = NULL,

    @ElectricIsolationMethodNotApplicable bit,
    @ElectricIsolationMethodLOTO bit,
    @ElectricIsolationMethodWiring bit,
    @ElectricTestBumpNotApplicable bit,
    @ElectricTestBump bit = NULL,
    @EquipmentStillContainsResidualNotApplicable bit,
    @EquipmentStillContainsResidual bit = NULL,
    
    @EquipmentLeakingValvesNotApplicable bit,
    @EquipmentLeakingValves bit = NULL,
    @EquipmentIsOutOfService bit = NULL,
    @EquipmentConditionNotApplicable bit,
    @EquipmentConditionDepressured bit,
    @EquipmentConditionDrained bit,
    @EquipmentConditionCleaned bit,
    @EquipmentConditionVentilated bit,
    @EquipmentConditionH20Washed bit,
	@EquipmentConditionPurgedChecked bit, --vibhor
    @EquipmentConditionNeutralized bit,
    @EquipmentConditionPurged bit,
    @EquipmentConditionPurgedN2 bit,
    @EquipmentConditionPurgedSteamed bit,
    @EquipmentConditionPurgedAir bit,   
    @EquipmentConditionPurgedDescription varchar(50) = NULL,
    @EquipmentConditionOtherDescription varchar(50) = NULL,
    @EquipmentPreviousContentsNotApplicable bit,
    @EquipmentPreviousContentsHydrocarbon bit,
    @EquipmentPreviousContentsAcid bit,
    @EquipmentPreviousContentsCaustic bit,
    @EquipmentPreviousContentsH2S bit,
    @EquipmentPreviousContentsOtherDescription varchar(50) = NULL,
	@EquipmentAsbestosGasketsNotApplicable bit,
	@EquipmentAsbestosGaskets bit = NULL,
    @EquipmentIsolationMethodNotApplicable bit,
    @EquipmentIsolationMethodBlockedIn bit,
    @EquipmentIsolationMethodCarBer bit,
    @EquipmentIsolationMethodBlindedorBlanked bit,
    @EquipmentIsolationMethodSeparation bit,
    @EquipmentIsolationMethodMudderPlugs bit,
    @EquipmentIsolationMethodLOTO bit,
    @EquipmentIsolationMethodOtherDescription varchar(50) = NULL,
    @EquipmentVentilationMethodNotApplicable bit,
    @EquipmentVentilationMethodNaturalDraft bit,
    @EquipmentVentilationMethodLocalExhaust bit,
    @EquipmentVentilationMethodForced bit,
    
    @EquipmentIsHazardousEnergyIsolationRequiredNotApplicable bit,
    @EquipmentIsHazardousEnergyIsolationRequired bit = NULL,
    @EquipmentLockOutMethodId bigint = NULL,
    @EquipmentLockOutMethodComments varchar(600) = NULL,
    @EquipmentEnergyIsolationPlanNumber varchar(100) = NULL,
    @EquipmentConditionsOfEIPSatisfied bit = NULL,
    @EquipmentConditionsOfEIPNotSatisfiedComments varchar(400) = NULL,

    @AsbestosHazardsConsideredNotApplicable bit,
    @AsbestosHazardsConsidered bit = NULL,

    @JobSitePreparationFlowRequiredForJob bit = NULL,
    @JobSitePreparationFlowRequiredForJobNotApplicable bit,
    @JobSitePreparationBondingOrGroundingRequiredNotApplicable bit,
    @JobSitePreparationBondingOrGroundingRequired bit = NULL,
    @JobSitePreparationWeldingGroundWireInTestAreaNotApplicable bit,
    @JobSitePreparationWeldingGroundWireInTestArea bit = NULL,
    @JobSitePreparationCriticalConditionRemainJobSiteNotApplicable bit,
    @JobSitePreparationCriticalConditionRemainJobSite bit = NULL,
    @JobSitePreparationSurroundingConditionsAffectOrContaminatedNotApplicable bit,
	@ControlRoomContactedNotApplicable bit, --vibhor
    @JobSitePreparationSurroundingConditionsAffectOrContaminated bit = NULL,
    @JobSitePreparationVestedBuddySystemInEffectNotApplicable bit,
    @JobSitePreparationVestedBuddySystemInEffect bit = NULL,
    @JobSitePreparationPermitReceiverFieldOrEquipmentOrientationNotApplicable bit,

    @JobSitePreparationPermitReceiverFieldOrEquipmentOrientation bit = NULL,
	@IsControlRoomContactedOrNot bit = NULL, --vibhor
    @JobSitePreparationSewerIsolationMethodNotApplicable bit,
    @JobSitePreparationSewerIsolationMethodSealedOrCovered bit,
    @JobSitePreparationSewerIsolationMethodPlugged bit,
    @JobSitePreparationSewerIsolationMethodBlindedOrBlanked bit,
    @JobSitePreparationSewerIsolationMethodOtherDescription varchar(50) = NULL,
   
    @JobSitePreparationAreaPreparationNotApplicable bit,
    @JobSitePreparationAreaPreparationBarricade bit,
    @JobSitePreparationAreaPreparationNonEssentialEvac bit,
    @JobSitePreparationAreaPreparationPreopBoundaryRopeTape bit,
    @JobSitePreparationAreaPreparationRadiationRope bit,
    @JobSitePreparationAreaPreparationOtherDescription varchar(50) = NULL,
    @JobSitePreparationLightingElectricalRequirementNotApplicable bit,
    @JobSitePreparationLightingElectricalRequirementLowVoltage12V bit,
    @JobSitePreparationLightingElectricalRequirement110VWithGFCI bit,
    @JobSitePreparationLightingElectricalRequirementGeneratorLights bit,
    @JobSitePreparationLightingElectricalRequirementOtherDescription varchar(50) = NULL,

    @RadiationSealedSourceIsolationNotApplicable bit,
    @RadiationSealedSourceIsolationLOTO bit,
    @RadiationSealedSourceIsolationOpen bit,
    @RadiationSealedSourceIsolationNumberOfSources int = null,

    @GasTestFrequencyOrDuration varchar(50) = NULL,
    @GasTestConstantMonitoringRequired bit,
	@GasTestForkliftNotUsed bit,
    @GasTestTestTime datetime,
    @GasTestConfinedSpaceTestTime datetime,
    @GasTestSystemEntryTestTime datetime,

    @FireConfinedSpaceNotApplicable bit,
    @FireConfinedSpace20ABCorDryChemicalExtinguisher bit,
    @FireConfinedSpaceC02Extinguisher bit,
    @FireConfinedSpaceFireResistantTarp bit,
    @FireConfinedSpaceSparkContainment bit,
    @FireConfinedSpaceWaterHose bit,
    @FireConfinedSpaceSteamHose bit,
    @FireConfinedSpaceWatchmen bit,    
    @FireConfinedSpaceHoleWatchNumber varchar(50) = NULL,
    @FireConfinedSpaceFireWatchNumber varchar(50) = NULL,
    @FireConfinedSpaceSpotterNumber varchar(50) = NULL,
    @FireConfinedSpaceOtherDescription varchar(50) = NULL,

    @RespitoryProtectionRequirementsNotApplicable bit,
    @RespitoryProtectionRequirementsAirCartOrAirLine bit,
    @RespitoryProtectionRequirementsSCBA bit,
    @RespitoryProtectionRequirementsHalfFaceRespirator bit,
    @RespitoryProtectionRequirementsFullFaceRespirator bit,
    @RespitoryProtectionRequirementsDustMask bit,
    @RespitoryProtectionRequirementsAirHood bit,
    @RespitoryProtectionRequirementsOtherDescription varchar(50) = NULL,
    @RespitoryProtectionRequirementsRespiratoryCartridgeTypeDescription varchar(50) = NULL,
    @RespitoryProtectionRequirementsRespiratoryCartridgeTypeId bigint = NULL,

    @SpecialEyeOrFaceProtectionNotApplicable bit,
    @SpecialEyeOrFaceProtectionGoggles bit,
    @SpecialEyeOrFaceProtectionFaceshield bit,
    @SpecialEyeOrFaceProtectionOtherDescription varchar(50) = NULL,

    @SpecialProtectiveClothingTypeNotApplicable bit,
    @SpecialProtectiveClothingTypeRainCoat bit,
    @SpecialProtectiveClothingTypeRainPants bit,
    @SpecialProtectiveClothingTypeAcidClothing bit,
    @SpecialProtectiveClothingTypeAcidClothingTypeID int=null,
    @SpecialProtectiveClothingTypeCausticWear bit,
	@SpecialProtectiveClothingTypePaperCoveralls bit,	
	@SpecialProtectiveClothingTypeTyvekSuit bit,
	@SpecialProtectiveClothingTypeKapplerSuit bit,
	@SpecialProtectiveClothingTypeElectricalFlashGear bit,
	@SpecialProtectiveClothingTypeCorrosiveClothing bit,
    @SpecialProtectiveClothingTypeOtherDescripton varchar(50)=NULL,

    @SpecialProtectiveFootwearNotApplicable bit,
    @SpecialProtectiveFootwearChemicalImperviousBoots bit,
    @SpecialProtectiveFootwearToeGuard bit,
    @SpecialProtectiveFootwearMetatarsalGuard bit,
    @SpecialProtectiveFootwearOtherDescription varchar(50)=NULL,

    @SpecialHandProtectionNotApplicable bit,
    @SpecialHandProtectionChemicalNeprene bit,
    @SpecialHandProtectionNaturalRubber bit,
    @SpecialHandProtectionNitrile bit,
    @SpecialHandProtectionPVC bit,
    @SpecialHandProtectionHighVoltage bit,
    @SpecialHandProtectionWelding bit,
    @SpecialHandProtectionLeather bit,
    @SpecialHandProtectionChemicalGloves bit,    
    @SpecialHandProtectionOtherDescription varchar(50)=NULL,

    @SpecialRescueOrFallNotApplicable bit,
    @SpecialRescueOrFallBodyHarness bit,
    @SpecialRescueOrFallLifeline bit,
    @SpecialRescueOrFallYoYo bit,
    @SpecialRescueOrFallRescueDevice bit,
    @SpecialRescueOrFallOtherDescription varchar(50)=NULL,

	@SpecialFallOtherDescription varchar(50) = NULL,
	@SpecialFallRestraint bit,
	@SpecialFallSelfRetractingDevice bit,
	@SpecialFallTieoffRequired bit = NULL,
	
    @SourceId int,
    @LastModifiedUserId bigint,
    @LastModifiedDateTime datetime,
    @ApprovedByUserId bigint = NULL,
    @Deleted bit =0,	
    @Id bigint,

    @EquipmentStillContainsResidualComments varchar(400)= NULL,
    @EquipmentInServiceComments varchar(400)= NULL,
    @EquipmentNoElectricalTestBumpComments varchar(400)= NULL,
    @EquipmentLeakingValvesComments varchar(400)= NULL,
	@EquipmentInAsbestosHazardPresentComments varchar(400)= NULL, --vibhor

	
    @JobSitePreparationFlowRequiredComments varchar(400)= NULL,
    @JobSitePreparationBondingGroundingNotRequiredComments varchar(400)= NULL,
    @JobSitePreparationWeldingGroundWireNotWithinGasTestAreaComments varchar(400)= NULL,
    @JobSitePreparationSurroundingConditionsAffectAreaComments varchar(400)= NULL,
    @JobSitePreparationCriticalConditionsComments varchar(400)= NULL,
    @JobSitePreparationPermitReceiverRequiresOrientationComments varchar(400)= NULL,
    
	@WorkAssignmentId bigint = NULL
)
AS
    
UPDATE
    WorkPermit
SET
    Version = @Version,
    WorkPermitStatusId = @WorkPermitStatusId,
    FunctionalLocationId = @FunctionalLocationId,
    PermitNumber = @PermitNumber,
    WorkOrderNumber = @WorkOrderNumber,
    SapOperationId = @SapOperationId,
    StartDateTime = @StartDateTime,
	StartTimeNotApplicable = @StartTimeNotApplicable,
    EndDateTime = @EndDateTime,
    StartAndOrEndTimesFinalized = @StartAndOrEndTimesFinalized,
    PermitValidDateTime = @PermitValidDateTime,
    WorkPermitTypeId = @WorkPermitTypeId,
    WorkPermitTypeClassificationId = @WorkPermitTypeClassificationId,
    WorkOrderDescription = @WorkOrderDescription,
    SpecialPrecautionsOrConsiderationsDescription = @SpecialPrecautionsOrConsiderationsDescription,
    RevalidationDateTime=@RevalidationDateTime,
    ExtensionDateTime=@ExtensionDateTime,
    ExtensionRevalidationDateTime=@ExtensionRevalidationDateTime,
    ExtensionTimeIssuer =@ExtensionTimeIssuer,
    ExtensionTimeNonIssuer =@ExtensionTimeNonIssuer, 
    ISSUER_SOURCEXTENSION =@ISSUER_SOURCEXTENSION , 
    Revalidation=@Revalidation, 
    Extension=@Extension,
    ExtensionEnable=@ExtensionEnable,
    RevalidationEnable=@RevalidationEnable,
    BeforeExtensionDateTime=@BeforeExtensionDateTime, 
    MidExtensionvalueIssuer=@MidExtensionvalueIssuer,
    MidExtensionvaluenonIssuer=@MidExtensionvaluenonIssuer, 
    PermitConfinedSpaceEntry = @PermitConfinedSpaceEntry,
    PermitBreathingAirOrSCBA = @PermitBreathingAirOrSCBA,
    PermitElectricalWork = @PermitElectricalWork,
    PermitVehicleEntry = @PermitVehicleEntry,
    PermitHotTap = @PermitHotTap,
    PermitBurnOrOpenFlame = @PermitBurnOrOpenFlame,
    PermitSystemEntry = @PermitSystemEntry,
    PermitCriticalLift = @PermitCriticalLift,
    PermitExcavation = @PermitExcavation,
    PermitAsbestos = @PermitAsbestos,
    PermitRadiationRadiography = @PermitRadiationRadiography,
    PermitRadiationSealed = @PermitRadiationSealed,
    PermitInertConfinedSpaceEntry = @PermitInertConfinedSpaceEntry,
    PermitLeadAbatement = @PermitLeadAbatement,
	PermitFreshAir = @PermitFreshAir, --vibhor
	ControlRoomContacted=@ControlRoomContacted, --vibhor

    AdditionalCSEAssessmentOrAuthorization = @AdditionalCSEAssessmentOrAuthorization,
    AdditionalCSEAssessmentOrAuthorizationDescription = @AdditionalCSEAssessmentOrAuthorizationDescription,
    AdditionalFlareEntry = @AdditionalFlareEntry,
    AdditionalCriticalLift = @AdditionalCriticalLift,
    AdditionalCriticalLiftDescription = @AdditionalCriticalLiftDescription,
    AdditionalExcavation = @AdditionalExcavation,
    AdditionalExcavationDescription = @AdditionalExcavationDescription,
    AdditionalHotTap = @AdditionalHotTap,
    AdditionalSpecialWasteDisposal = @AdditionalSpecialWasteDisposal,
    AdditionalBlankOrBlindLists = @AdditionalBlankOrBlindLists,
    AdditionalPJSROrSafetyPause = @AdditionalPJSROrSafetyPause,
    AdditionalAsbestosHandling = @AdditionalAsbestosHandling,
    AdditionalAsbestosHandlingDescription = @AdditionalAsbestosHandlingDescription,
    AdditionalRoadClosure = @AdditionalRoadClosure,
    AdditionalElectrical = @AdditionalElectrical,
    AdditionalElectricalDescription = @AdditionalElectricalDescription,
    AdditionalBurnOrOpenFlameAssessment = @AdditionalBurnOrOpenFlameAssessment,
    AdditionalBurnOrOpenFlameAssessmentDescription = @AdditionalBurnOrOpenFlameAssessmentDescription,
    AdditionalWaiverOrDeviation = @AdditionalWaiverOrDeviation,
    AdditionalWaiverOrDeviationDescription = @AdditionalWaiverOrDeviationDescription,
    AdditionalMSDS = @AdditionalMSDS,
    AdditionalOtherFormsOrAssessmentsOrAuthorizations = @AdditionalOtherFormsOrAssessmentsOrAuthorizations,
    AdditionalRadiationApproval = @AdditionalRadiationApproval,
    AdditionalOnlineLeakRepairForm = @AdditionalOnlineLeakRepairForm,
	AdditionalIsEnergizedElectricalForm = @AdditionalIsEnergizedElectricalForm,
	AdditionalIsNotApplicable = @AdditionalIsNotApplicable,

    ContactPersonnel = @ContactPersonnel,
    ContractorCompanyName = @ContractorCompanyName,
    CraftOrTradeID = @CraftOrTradeID,
    CraftOrTradeOther = @CraftOrTradeOther,
    JobStepDescription = @JobStepDescription,
    CommunicationByRadio = @CommunicationByRadio,
    CommunicationRadioChannelOrBand = @CommunicationRadioChannelOrBand,
    IsWorkPermitCommunicationNotApplicable = @IsWorkPermitCommunicationNotApplicable,
    CommunicationRadioColor = @CommunicationRadioColor,
    CommunicationByOtherDescription = @CommunicationByOtherDescription,
    CoAuthorizationDescription = @CoAuthorizationDescription,
    CoAuthorizationRequired = @CoAuthorizationRequired,

    ToolsAirTools = @ToolsAirTools,
    ToolsCraneOrCarrydeck = @ToolsCraneOrCarrydeck,
    ToolsHandTools = @ToolsHandTools,
    ToolsJackhammer = @ToolsJackhammer,
    ToolsVacuumTruck = @ToolsVacuumTruck,
    ToolsCementSaw = @ToolsCementSaw,
    ToolsElectricTools = @ToolsElectricTools,
    ToolsHeavyEquipment = @ToolsHeavyEquipment,
    ToolsLanda = @ToolsLanda,
    ToolsScaffolding = @ToolsScaffolding,
    ToolsVehicle = @ToolsVehicle,
    ToolsCompressor = @ToolsCompressor,
    ToolsForklift = @ToolsForklift,
    ToolsHEPAVacuum = @ToolsHEPAVacuum,
    ToolsManlift = @ToolsManlift,
    ToolsTamper = @ToolsTamper,
    ToolsHotTapMachine = @ToolsHotTapMachine,
    ToolsPortLighting = @ToolsPortLighting,
    ToolsTorch = @ToolsTorch,
    ToolsWelder = @ToolsWelder,
    ToolsChemicals = @ToolsChemicals,
    ToolsOtherToolsDescription = @ToolsOtherToolsDescription,

    ElectricIsolationMethodNotApplicable = @ElectricIsolationMethodNotApplicable,
    ElectricIsolationMethodLOTO = @ElectricIsolationMethodLOTO,
    ElectricIsolationMethodWiring = @ElectricIsolationMethodWiring,
    ElectricTestBumpNotApplicable = @ElectricTestBumpNotApplicable,
    ElectricTestBump = @ElectricTestBump,

    EquipmentStillContainsResidualNotApplicable = @EquipmentStillContainsResidualNotApplicable,
    EquipmentStillContainsResidual = @EquipmentStillContainsResidual,    
    EquipmentLeakingValvesNotApplicable = @EquipmentLeakingValvesNotApplicable,
    EquipmentLeakingValves = @EquipmentLeakingValves,
    EquipmentIsOutOfService = @EquipmentIsOutOfService,
    EquipmentConditionNotApplicable = @EquipmentConditionNotApplicable,
    EquipmentConditionDepressured = @EquipmentConditionDepressured,
    EquipmentConditionDrained = @EquipmentConditionDrained,
    EquipmentConditionCleaned = @EquipmentConditionCleaned,
    EquipmentConditionVentilated = @EquipmentConditionVentilated,
    EquipmentConditionH20Washed = @EquipmentConditionH20Washed,
    EquipmentConditionNeutralized = @EquipmentConditionNeutralized,
	EquipmentConditionPurgedChecked = @EquipmentConditionPurgedChecked, --vibhor
    EquipmentConditionPurged = @EquipmentConditionPurged,    
    EquipmentConditionPurgedN2 = @EquipmentConditionPurgedN2,
    EquipmentConditionPurgedSteamed = @EquipmentConditionPurgedSteamed,
    EquipmentConditionPurgedAir = @EquipmentConditionPurgedAir,
    EquipmentConditionPurgedDescription = @EquipmentConditionPurgedDescription,
    EquipmentConditionOtherDescription = @EquipmentConditionOtherDescription,
    EquipmentPreviousContentsNotApplicable = @EquipmentPreviousContentsNotApplicable,
    EquipmentPreviousContentsHydrocarbon = @EquipmentPreviousContentsHydrocarbon,
    EquipmentPreviousContentsAcid = @EquipmentPreviousContentsAcid,
    EquipmentPreviousContentsCaustic = @EquipmentPreviousContentsCaustic,
    EquipmentPreviousContentsH2S = @EquipmentPreviousContentsH2S,
    EquipmentPreviousContentsOtherDescription = @EquipmentPreviousContentsOtherDescription,
	EquipmentAsbestosGasketsNotApplicable = @EquipmentAsbestosGasketsNotApplicable,
	EquipmentAsbestosGaskets = @EquipmentAsbestosGaskets,
    EquipmentIsolationMethodNotApplicable = @EquipmentIsolationMethodNotApplicable, 
    EquipmentIsolationMethodBlindedorBlanked = @EquipmentIsolationMethodBlindedorBlanked, 
    EquipmentIsolationMethodSeparation = @EquipmentIsolationMethodSeparation, 
    EquipmentIsolationMethodMudderPlugs = @EquipmentIsolationMethodMudderPlugs, 
    EquipmentIsolationMethodLOTO = @EquipmentIsolationMethodLOTO, 
    EquipmentIsolationMethodBlockedIn=@EquipmentIsolationMethodBlockedIn,
    EquipmentIsolationMethodCarBer=@EquipmentIsolationMethodCarBer,
    EquipmentIsolationMethodOtherDescription = @EquipmentIsolationMethodOtherDescription, 
    EquipmentVentilationMethodNotApplicable = @EquipmentVentilationMethodNotApplicable, 
    EquipmentVentilationMethodNaturalDraft = @EquipmentVentilationMethodNaturalDraft, 
    EquipmentVentilationMethodLocalExhaust = @EquipmentVentilationMethodLocalExhaust, 
    EquipmentVentilationMethodForced = @EquipmentVentilationMethodForced, 
    
    EquipmentIsHazardousEnergyIsolationRequiredNotApplicable = @EquipmentIsHazardousEnergyIsolationRequiredNotApplicable,
    EquipmentIsHazardousEnergyIsolationRequired = @EquipmentIsHazardousEnergyIsolationRequired,
    EquipmentLockOutMethodId = @EquipmentLockOutMethodId,
    EquipmentLockOutMethodComments = @EquipmentLockOutMethodComments,
    EquipmentEnergyIsolationPlanNumber = @EquipmentEnergyIsolationPlanNumber,
    EquipmentConditionsOfEIPSatisfied = @EquipmentConditionsOfEIPSatisfied,
    EquipmentConditionsOfEIPNotSatisfiedComments = @EquipmentConditionsOfEIPNotSatisfiedComments,

    AsbestosHazardsConsideredNotApplicable = @AsbestosHazardsConsideredNotApplicable,
    AsbestosHazardsConsidered = @AsbestosHazardsConsidered,

    JobSitePreparationFlowRequiredForJob = @JobSitePreparationFlowRequiredForJob, 
    JobSitePreparationFlowRequiredForJobNotApplicable = @JobSitePreparationFlowRequiredForJobNotApplicable, 
    JobSitePreparationBondingOrGroundingRequiredNotApplicable = @JobSitePreparationBondingOrGroundingRequiredNotApplicable, 
    JobSitePreparationBondingOrGroundingRequired = @JobSitePreparationBondingOrGroundingRequired, 
    JobSitePreparationWeldingGroundWireInTestAreaNotApplicable = @JobSitePreparationWeldingGroundWireInTestAreaNotApplicable, 
    JobSitePreparationWeldingGroundWireInTestArea = @JobSitePreparationWeldingGroundWireInTestArea, 
    JobSitePreparationCriticalConditionRemainJobSiteNotApplicable = @JobSitePreparationCriticalConditionRemainJobSiteNotApplicable, 
    JobSitePreparationCriticalConditionRemainJobSite = @JobSitePreparationCriticalConditionRemainJobSite, 
    JobSitePreparationSurroundingConditionsAffectOrContaminatedNotApplicable = @JobSitePreparationSurroundingConditionsAffectOrContaminatedNotApplicable,
    JobSitePreparationSurroundingConditionsAffectOrContaminated = @JobSitePreparationSurroundingConditionsAffectOrContaminated, 
	ControlRoomContactedNotApplicable=@ControlRoomContactedNotApplicable, --vibhor
    JobSitePreparationVestedBuddySystemInEffectNotApplicable = @JobSitePreparationVestedBuddySystemInEffectNotApplicable, 
    JobSitePreparationVestedBuddySystemInEffect = @JobSitePreparationVestedBuddySystemInEffect, 
    JobSitePreparationPermitReceiverFieldOrEquipmentOrientationNotApplicable = @JobSitePreparationPermitReceiverFieldOrEquipmentOrientationNotApplicable,
    JobSitePreparationPermitReceiverFieldOrEquipmentOrientation = @JobSitePreparationPermitReceiverFieldOrEquipmentOrientation, 
	IsControlRoomContactedOrNot = @IsControlRoomContactedOrNot, --vibhor
	 
    JobSitePreparationSewerIsolationMethodNotApplicable = @JobSitePreparationSewerIsolationMethodNotApplicable, 
    JobSitePreparationSewerIsolationMethodSealedOrCovered = @JobSitePreparationSewerIsolationMethodSealedOrCovered, 
    JobSitePreparationSewerIsolationMethodPlugged = @JobSitePreparationSewerIsolationMethodPlugged, 
    JobSitePreparationSewerIsolationMethodBlindedOrBlanked = @JobSitePreparationSewerIsolationMethodBlindedOrBlanked, 
    JobSitePreparationSewerIsolationMethodOtherDescription = @JobSitePreparationSewerIsolationMethodOtherDescription, 
    
    JobSitePreparationAreaPreparationNotApplicable = @JobSitePreparationAreaPreparationNotApplicable, 
    JobSitePreparationAreaPreparationBarricade = @JobSitePreparationAreaPreparationBarricade, 
    JobSitePreparationAreaPreparationNonEssentialEvac = @JobSitePreparationAreaPreparationNonEssentialEvac, 
    JobSitePreparationAreaPreparationPreopBoundaryRopeTape = @JobSitePreparationAreaPreparationPreopBoundaryRopeTape,
    JobSitePreparationAreaPreparationRadiationRope= @JobSitePreparationAreaPreparationRadiationRope,
    JobSitePreparationAreaPreparationOtherDescription = @JobSitePreparationAreaPreparationOtherDescription, 
    JobSitePreparationLightingElectricalRequirementNotApplicable = @JobSitePreparationLightingElectricalRequirementNotApplicable, 
    JobSitePreparationLightingElectricalRequirementLowVoltage12V = @JobSitePreparationLightingElectricalRequirementLowVoltage12V, 
    JobSitePreparationLightingElectricalRequirement110VWithGFCI = @JobSitePreparationLightingElectricalRequirement110VWithGFCI, 
    JobSitePreparationLightingElectricalRequirementGeneratorLights = @JobSitePreparationLightingElectricalRequirementGeneratorLights, 
    JobSitePreparationLightingElectricalRequirementOtherDescription = @JobSitePreparationLightingElectricalRequirementOtherDescription, 

    RadiationSealedSourceIsolationNotApplicable = @RadiationSealedSourceIsolationNotApplicable, 
    RadiationSealedSourceIsolationLOTO = @RadiationSealedSourceIsolationLOTO, 
    RadiationSealedSourceIsolationOpen = @RadiationSealedSourceIsolationOpen, 
    RadiationSealedSourceIsolationNumberOfSources = @RadiationSealedSourceIsolationNumberOfSources, 
    
    GasTestFrequencyOrDuration = @GasTestFrequencyOrDuration,
    GasTestConstantMonitoringRequired = @GasTestConstantMonitoringRequired,
	GasTestForkliftNotUsed = @GasTestForkliftNotUsed,
    GasTestTestTime = @GasTestTestTime,
    GasTestConfinedSpaceTestTime = @GasTestConfinedSpaceTestTime,
    GasTestSystemEntryTestTime = @GasTestSystemEntryTestTime,

    FireConfinedSpaceNotApplicable = @FireConfinedSpaceNotApplicable,
    FireConfinedSpace20ABCorDryChemicalExtinguisher = @FireConfinedSpace20ABCorDryChemicalExtinguisher,
    FireConfinedSpaceC02Extinguisher = @FireConfinedSpaceC02Extinguisher,
    FireConfinedSpaceFireResistantTarp = @FireConfinedSpaceFireResistantTarp,
    FireConfinedSpaceSparkContainment = @FireConfinedSpaceSparkContainment,
    FireConfinedSpaceWaterHose = @FireConfinedSpaceWaterHose,
    FireConfinedSpaceSteamHose = @FireConfinedSpaceSteamHose,
    FireConfinedSpaceWatchmen = @FireConfinedSpaceWatchmen,
    FireConfinedSpaceHoleWatchNumber = @FireConfinedSpaceHoleWatchNumber,    
    FireConfinedSpaceFireWatchNumber = @FireConfinedSpaceFireWatchNumber,
    FireConfinedSpaceSpotterNumber = @FireConfinedSpaceSpotterNumber,
    FireConfinedSpaceOtherDescription = @FireConfinedSpaceOtherDescription,

    RespitoryProtectionRequirementsNotApplicable = @RespitoryProtectionRequirementsNotApplicable,
    RespitoryProtectionRequirementsAirCartOrAirLine = @RespitoryProtectionRequirementsAirCartOrAirLine,
    RespitoryProtectionRequirementsSCBA = @RespitoryProtectionRequirementsSCBA,
    RespitoryProtectionRequirementsHalfFaceRespirator = @RespitoryProtectionRequirementsHalfFaceRespirator,
    RespitoryProtectionRequirementsFullFaceRespirator = @RespitoryProtectionRequirementsFullFaceRespirator, 
    RespitoryProtectionRequirementsDustMask = @RespitoryProtectionRequirementsDustMask, 
    RespitoryProtectionRequirementsAirHood = @RespitoryProtectionRequirementsAirHood, 
    RespitoryProtectionRequirementsOtherDescription = @RespitoryProtectionRequirementsOtherDescription, 
    RespitoryProtectionRequirementsRespiratoryCartridgeTypeDescription = @RespitoryProtectionRequirementsRespiratoryCartridgeTypeDescription,
    RespitoryProtectionRequirementsRespiratoryCartridgeTypeId = @RespitoryProtectionRequirementsRespiratoryCartridgeTypeId,

    SpecialEyeOrFaceProtectionNotApplicable = @SpecialEyeOrFaceProtectionNotApplicable,
    SpecialEyeOrFaceProtectionGoggles = @SpecialEyeOrFaceProtectionGoggles, 
    SpecialEyeOrFaceProtectionFaceshield = @SpecialEyeOrFaceProtectionFaceshield, 
    SpecialEyeOrFaceProtectionOtherDescription = @SpecialEyeOrFaceProtectionOtherDescription, 

    SpecialProtectiveClothingTypeNotApplicable = @SpecialProtectiveClothingTypeNotApplicable,
    SpecialProtectiveClothingTypeRainCoat = @SpecialProtectiveClothingTypeRainCoat, 
    SpecialProtectiveClothingTypeRainPants = @SpecialProtectiveClothingTypeRainPants, 
    SpecialProtectiveClothingTypeAcidClothing = @SpecialProtectiveClothingTypeAcidClothing, 
    SpecialProtectiveClothingTypeAcidClothingTypeID = @SpecialProtectiveClothingTypeAcidClothingTypeID, 
    SpecialProtectiveClothingTypeCausticWear = @SpecialProtectiveClothingTypeCausticWear, 
	SpecialProtectiveClothingTypePaperCoveralls = @SpecialProtectiveClothingTypePaperCoveralls,	
	SpecialProtectiveClothingTypeTyvekSuit = @SpecialProtectiveClothingTypeTyvekSuit,
	SpecialProtectiveClothingTypeKapplerSuit = @SpecialProtectiveClothingTypeKapplerSuit,
	SpecialProtectiveClothingTypeElectricalFlashGear = @SpecialProtectiveClothingTypeElectricalFlashGear,
	SpecialProtectiveClothingTypeCorrosiveClothing = @SpecialProtectiveClothingTypeCorrosiveClothing,
    SpecialProtectiveClothingTypeOtherDescripton = @SpecialProtectiveClothingTypeOtherDescripton, 

    SpecialProtectiveFootwearNotApplicable = @SpecialProtectiveFootwearNotApplicable,
    SpecialProtectiveFootwearChemicalImperviousBoots = @SpecialProtectiveFootwearChemicalImperviousBoots, 
    SpecialProtectiveFootwearToeGuard = @SpecialProtectiveFootwearToeGuard,
    SpecialProtectiveFootwearMetatarsalGuard = @SpecialProtectiveFootwearMetatarsalGuard, 
    SpecialProtectiveFootwearOtherDescription = @SpecialProtectiveFootwearOtherDescription, 

    SpecialHandProtectionNotApplicable = @SpecialHandProtectionNotApplicable,
    SpecialHandProtectionChemicalNeprene = @SpecialHandProtectionChemicalNeprene, 
    SpecialHandProtectionNaturalRubber = @SpecialHandProtectionNaturalRubber,
    SpecialHandProtectionNitrile = @SpecialHandProtectionNitrile,
    SpecialHandProtectionPVC = @SpecialHandProtectionPVC,
    SpecialHandProtectionHighVoltage = @SpecialHandProtectionHighVoltage,
    SpecialHandProtectionWelding = @SpecialHandProtectionWelding,
    SpecialHandProtectionLeather = @SpecialHandProtectionLeather,
    SpecialHandProtectionChemicalGloves = @SpecialHandProtectionChemicalGloves,
    SpecialHandProtectionOtherDescription = @SpecialHandProtectionOtherDescription,

    SpecialRescueOrFallNotApplicable = @SpecialRescueOrFallNotApplicable,
    SpecialRescueOrFallBodyHarness = @SpecialRescueOrFallBodyHarness,
    SpecialRescueOrFallLifeline = @SpecialRescueOrFallLifeline,
    SpecialRescueOrFallYoYo = @SpecialRescueOrFallYoYo,
    SpecialRescueOrFallRescueDevice = @SpecialRescueOrFallRescueDevice,
    SpecialRescueOrFallOtherDescription = @SpecialRescueOrFallOtherDescription,
	
	SpecialFallOtherDescription = @SpecialFallOtherDescription,
	SpecialFallRestraint = @SpecialFallRestraint,
	SpecialFallSelfRetractingDevice = @SpecialFallSelfRetractingDevice,
	SpecialFallTieoffRequired = @SpecialFallTieoffRequired,

    SourceId = @SourceId,
    LastModifiedUserId = @LastModifiedUserId,
    LastModifiedDate = @LastModifiedDateTime,
    ApprovedByUserId = @ApprovedByUserId,
    Deleted = @Deleted,

    EquipmentStillContainsResidualComments=@EquipmentStillContainsResidualComments,
    EquipmentInServiceComments=@EquipmentInServiceComments,
    EquipmentNoElectricalTestBumpComments=@EquipmentNoElectricalTestBumpComments,
    EquipmentLeakingValvesComments=@EquipmentLeakingValvesComments,
	EquipmentInAsbestosHazardPresentComments=@EquipmentInAsbestosHazardPresentComments, --vibhor

	
    JobSitePreparationFlowRequiredComments=@JobSitePreparationFlowRequiredComments,
    JobSitePreparationBondingGroundingNotRequiredComments=@JobSitePreparationBondingGroundingNotRequiredComments,
    JobSitePreparationWeldingGroundWireNotWithinGasTestAreaComments=@JobSitePreparationWeldingGroundWireNotWithinGasTestAreaComments,
    JobSitePreparationSurroundingConditionsAffectAreaComments=@JobSitePreparationSurroundingConditionsAffectAreaComments,
    JobSitePreparationCriticalConditionsComments=@JobSitePreparationCriticalConditionsComments,
    JobSitePreparationPermitReceiverRequiresOrientationComments=@JobSitePreparationPermitReceiverRequiresOrientationComments,
WorkAssignmentId = @WorkAssignmentId
    
WHERE
(
    Id = @Id
)

GRANT EXEC ON UpdateWorkPermit TO PUBLIC

GO
