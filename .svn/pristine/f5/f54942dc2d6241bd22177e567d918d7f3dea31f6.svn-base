-- Drop the old proc if it exists
IF EXISTS (SELECT * FROM sysobjects WHERE type = 'P' AND name = 'FunctionalLocationAddOrUndelete')
	BEGIN
		DROP PROCEDURE [dbo].FunctionalLocationAddOrUndelete
	END
GO

CREATE Procedure [dbo].FunctionalLocationAddOrUndelete
  (
    @SiteId bigint,
    @Description VARCHAR(50) = null,
    @FullHierarchy VARCHAR(90), 
    @PlantId bigint,
    @Level tinyint,
	@Culture VARCHAR(5)
  )
AS

IF NOT EXISTS(SELECT * FROM FunctionalLocation
  where FullHierarchy = @FullHierarchy AND SiteId = @SiteId AND PlantId = @PlantId)
  BEGIN
    INSERT INTO FunctionalLocation (
       SiteId, Description,FullHierarchy,OutOfService,Deleted
      ,[Level],PlantId,Culture
    ) VALUES (
       @SiteId   -- SiteId - bigint
      ,@Description  -- Description - varchar(50)
      ,@FullHierarchy  -- FullHierarchy - varchar(90)
      ,0  -- OutOfService - bit
      ,0  -- Deleted - bit
      ,@Level   -- Level - tinyint
      ,@PlantId   -- PlantId - bigint
	  ,@Culture -- Culture VARCHAR(5)
    )

    -- attach children to the newly added floc	
    INSERT INTO FunctionalLocationAncestor ([Id], [AncestorId], [AncestorLevel] ) (
  	SELECT 
  		c.id, a.id, a.[Level]
  		FROM FunctionalLocation a
  		INNER JOIN FunctionalLocation c 
  			ON c.siteid = a.siteid and 
  			c.[Level] > a.[Level] and
   			a.Fullhierarchy like c.fullhierarchy + '-%'
  	where
        a.Id = IDENT_CURRENT('FunctionalLocation')
  	  and
  	  NOT EXISTS(select id from FunctionalLocationAncestor where id = c.id and ancestorid = a.id)
    )

    -- attach parents to the newly added floc
  	INSERT INTO FunctionalLocationAncestor ([Id], [AncestorId], [AncestorLevel] ) (
  	SELECT 
  		c.id, a.id, a.[Level]
  		FROM FunctionalLocation a
  		INNER JOIN FunctionalLocation c 
  			ON c.siteid = a.siteid and 
  			c.[Level] > a.[Level] and
   			c.Fullhierarchy like a.fullhierarchy + '-%'
  		where
  			c.Id = IDENT_CURRENT('FunctionalLocation')
  			and
  			NOT EXISTS(select id from FunctionalLocationAncestor where id = c.id and ancestorid = a.id)
    )

  END
  
  IF EXISTS(SELECT * FROM FunctionalLocation 
    where FullHierarchy = @FullHierarchy AND SiteId = @SiteId AND PlantId = @PlantId AND DELETED = 1)
  BEGIN
    UPDATE FunctionalLocation
      SET 
      DELETED = 0,
      OutOfService = 0,
	  Description = @Description
    WHERE
      FullHierarchy = @FullHierarchy AND SiteId = @SiteId AND PlantId = @PlantId AND DELETED = 1
  END
GO

EXEC dbo.FunctionalLocationAddOrUndelete 6, N'BREAKER,260KV,29PL9-6 TO X260B1,29EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-952_106',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'BATTERY BANK 1,125VDC,P&C BLDG,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-B1',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'BATTERY BANK 2,125VDC,P&C BLDG,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-B2',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CHARGER BATTERY 1,125VDC,P&C BLDG,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-BC1',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CHARGER BATTERY 2,125VDC,P&C BLDG,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-BC2',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH A,29EDD1S152 TO 29EDD1S2',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT0001A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH B,29EDD1S152 TO 29EDD1S2',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT0001B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH C,29EDD1S152 TO 29EDD1S2',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT0001C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH A,29EDD1S252 TO 29EDD1S3',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT0002A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH B,29EDD1S252 TO 29EDD1S3',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT0002B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH C,29EDD1S252 TO 29EDD1S3',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT0002C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH A,29EDD1S352 TO 29EDD1S5',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT0003A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH B,29EDD1S352 TO 29EDD1S5',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT0003B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH C,29EDD1S352 TO 29EDD1S5',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT0003C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH A,29EDD1S452 TO 29EDD1S8',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT0004A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH B,29EDD1S452 TO 29EDD1S8',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT0004B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH C,29EDD1S452 TO 29EDD1S8',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT0004C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH A,29EDD1S552 TO 29EDD1S9',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT0005A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH B,29EDD1S552 TO 29EDD1S9',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT0005B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH C,29EDD1S552 TO 29EDD1S9',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT0005C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH A,29EDD1S652 TO 29EDD1S11',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT0006A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH B,29EDD1S652 TO 29EDD1S11',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT0006B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH C,29EDD1S652 TO 29EDD1S11',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT0006C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH A,29EDD1S752 TO 29EDD1S13',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT0007A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH B,29EDD1S752 TO 29EDD1S13',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT0007B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH C,29EDD1S752 TO 29EDD1S13',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT0007C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH A,29EDD1S852 TO 29EDD1S15',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT0008A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH B,29EDD1S852 TO 29EDD1S15',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT0008B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH C,29EDD1S852 TO 29EDD1S15',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT0008C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH A,29EDD1S952 TO 29EDD1S18',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT0009A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH B,29EDD1S952 TO 29EDD1S18',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT0009B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH C,29EDD1S952 TO 29EDD1S18',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT0009C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH A,29EDD1S1052 TO 29EDD1S19',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT0010A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH B,29EDD1S1052 TO 29EDD1S19',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT0010B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH C,29EDD1S1052 TO 29EDD1S19',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT0010C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH A,952-102 TO 29PS-405,EDDX1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT_952_102A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH B,952-102 TO 29PS-405,EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT_952_102B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH C,952-102 TO 29PS-405,EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT_952_102C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH A,952-103 TO 29PS-74,29EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT_952_103A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH B,952-103 TO 29PS-74,29EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT_952_103B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH C,952-103 TO 29PS-74,29EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT_952_103C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH A,952-105 TO 29PS-407,EDDX1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT_952_105A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH B,952-105 TO 29PS-407,EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT_952_105B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH C,952-105 TO 29PS-407,EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT_952_105C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH A,952-106 TO 29PS-138,EDDX1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT_952_106A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH B,952-106 TO 29PS-138,EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT_952_106B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CT,260KV,PH C,952-106 TO 29PS-138,EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-CT_952_106C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CVT,260KV,PH A,FOR LINE 29PL9-2,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT0001A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CVT,260KV,PH B,FOR LINE 29PL9-2,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT0001B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CVT,260KV,PH C,FOR LINE 29PL9-2,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT0001C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CVT,260KV,PH A,FOR LINE 29PL9-4,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT0002A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CVT,260KV,PH B,FOR LINE 29PL9-4,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT0002B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CVT,260KV,PH C,FOR LINE 29PL9-4,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT0002C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CVT,260KV,PH A,FOR LINE 29PL9-1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT0003A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CVT,260KV,PH B,FOR LINE 29PL9-1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT0003B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CVT,260KV,PH C,FOR LINE 29PL9-1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT0003C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CVT,260KV,PH A,FOR LINE 29PL9-3,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT0004A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CVT,260KV,PH B,FOR LINE 29PL9-3,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT0004B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CVT,260KV,PH C,FOR LINE 29PL9-3,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT0004C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CVT,260KV,PH B,FOR BUS N260B1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT0011',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CVT,260KV,PH A,FOR BUS N260B2,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT0013A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CVT,260KV,PH B,FOR BUS N260B2,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT0013B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CVT,260KV,PH C,FOR BUS N260B2,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT0013C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CVT,260KV,PH A,FOR BUS X260B2,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT0014A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CVT,260KV,PH B,FOR BUS X260B2,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT0014B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CVT,260KV,PH C,FOR BUS X260B2,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT0014C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'VT,72KV,PH A,FOR LINE 29PL6-3,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT10A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'VT,72KV,PH B,FOR LINE 29PL6-3,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT10B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'VT,72KV,PH C,FOR LINE 29PL6-3,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT10C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'VT,72KV,PH B,FOR BUS N72B1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT15',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'VT,72KV,PH B,FOR BUS X72B1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT16',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'VT,72KV,PH A,FOR LINE 29PL6-6,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT5A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'VT,72KV,PH B,FOR LINE 29PL6-6,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT5B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'VT,72KV,PH C,FOR LINE 29PL6-6,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT5C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'VT,72KV,PH A,FOR LINE 6L32,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT6A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'VT,72KV,PH B,FOR LINE 6L32,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT6B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'VT,72KV,PH C,FOR LINE 6L32,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT6C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'VT,72KV,PH A,FOR LINE 29PL6-22,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT7A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'VT,72KV,PH B,FOR LINE 29PL6-22,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT7B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'VT,72KV,PH C,FOR LINE 29PL6-22,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT7C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'VT,72KV,PH A,FOR LINE 29PL6-4,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT8A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'VT,72KV,PH B,FOR LINE 29PL6-4,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT8B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'VT,72KV,PH C,FOR LINE 29PL6-4,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT8C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'VT,72KV,PH A,FOR LINE 29PL6-5,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT9A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'VT,72KV,PH B,FOR LINE 29PL6-5,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT9B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'VT,72KV,PH C,FOR LINE 29PL6-5,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-CVT9C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,260KV,29EDD1S152 TO N260B1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S1',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,260KV,29EDD1S552 TO CVT4,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S10',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'BREAKER,260KV,W260B1 TO X260B2,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S1052',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,260KV,29EDD1S652 TO CVT4,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S11',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'BREAKER,72KV,29PL6-6 TO N72B1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S1152',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,260KV,29EDD1S652 TO X260B1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S12',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'BREAKER,72KV,CENTER NORTH 29PL6-6,6L32',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S1252',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,260KV,29EDD1S752 TO N260B1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S13',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'BREAKER,72KV,CENTER SOUTH 6L32,29PL6-22',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S1352',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,260KV,29EDD1S752 TO N260B2,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S14',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'BREAKER,72KV,29PL6-22 TO X72B1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S1452',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,260KV,29EDD1S852 TO X260B1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S15',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'BREAKER,260KV,29PL9-2 TO N260B1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S152',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'BREAKER,72KV,29PL6-4 TO N72B1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S1552',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,260KV,29EDD1S852 TO X260B2,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S16',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'BREAKER,72KV,CNTER NORTH 29PL6-4,29PL6-5',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S1652',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,260KV,29EDD1S952 TO N260B2,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S17',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'BREAKER,72KV,CNTER SOUTH 29PL6-5,29PL6-3',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S1752',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,260KV,29EDD1S952 TO W260B1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S18',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'BREAKER,72KV,29PL6-3 TO X72B1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S1852',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,260KV,29EDD1S1052 TO W260B1,EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S19',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,260KV,29EDD1S152 TO CVT1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S2',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,260KV,29EDD1S1052 TO X260B2,EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S20',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,260KV,T2 TO N260B2,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S21',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,72KV,T2 TO BUS N72B1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S22',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,260KV,T1 TO X260B2,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S23',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,72KV,T1 TO BUS X72B1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S24',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,72KV,29EDD1S1152 TO N72B1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S25',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'BREAKER,260KV,29PL9-2 TO 29PL9-4,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S252',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,72KV,29EDD1S1152 TO CVT5,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S26',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,72KV,29EDD1S1252 TO CVT5,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S27',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,72KV,29EDD1S1252 TO CVT6,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S28',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,72KV,29EDD1S1352 TO CVT6,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S29',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,260KV,29EDD1S252 TO CVT1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S3',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,72KV,29EDD1S1352 TO CVT7,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S30',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,72KV,29EDD1S1452 TO CVT7,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S31',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,72KV,29EDD1S1452 TO X72B1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S32',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,72KV,29EDD1S1552 TO N72B1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S33',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,72KV,29EDD1S1552 TO CVT8,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S34',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,72KV,29EDD1S1652 TO CVT8,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S35',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'BREAKER,260KV,29PL9-4 TO X260B1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S352',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,72KV,29EDD1S1652 TO CVT9,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S36',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,72KV,29EDD1S1752 TO CVT9,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S37',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,72KV,29EDD1S1752 TO CVT10,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S38',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,72KV,29EDD1S1852 TO CVT10,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S39',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,260KV,29EDD1S252 TO CVT2,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S4',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,72KV,29EDD1S1852 TO X72B1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S40',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'BREAKER,260KV,29PL9-1 TO N260B1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S452',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,260KV,29EDD1S352 TO CVT2,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S5',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'BREAKER,260KV,29PL9-1 TO 29PL9-3,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S552',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,260KV,29EDD1S352 TO X260B1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S6',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'BREAKER,260KV,29PL9-3 TO X260B1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S652',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,260KV,29EDD1S452 TO N260B1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S7',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'BREAKER,260KV,N260B1 TO N260B2,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S752',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,260KV,29EDD1S452 TO CVT3,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S8',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'BREAKER,260KV,X260B1 TO X260B2,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S852',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,260KV,29EDD1S552 TO CVT3,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S9',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'BREAKER,260KV,W260B1 TO N260B2,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1S952',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,72KV,FOR LINE 29PL6-3,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1SPL6_3',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,72KV,FOR LINE 29PL6-4,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1SPL6_4',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,260KV,FOR LINE 29PL9-1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1SPL9_1',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,260KV,FOR LINE 29PL9-2,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1SPL9_2',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,260KV,FOR LINE 29PL9-3,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1SPL9_3',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,260KV,FOR LINE 29PL9-4,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-EDD1SPL9_4',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,208/120VAC,DISTRIBUTION,41RA-1631',N'OS1-P029-MAIN-SEG-EDD001-SEG-PA0021',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,1,208/120VAC,260KV SIDE,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-PA0201',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,2,208/120VAC,72KV SIDE,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-PA0202',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,1A,208/120VAC,P&C BLDG,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-PA0203',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'BATTERY BANK,125VDC IN 41RA-1631,29EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-PB0009',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SPLITTER BOX,125VDC,MAIN DC IN 41RA-1631',N'OS1-P029-MAIN-SEG-EDD001-SEG-PD0007',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C,952-102 & 952-103,EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-PJ0054',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C FOR LINE 29PL9-6,EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-PJ0092',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C,952-105 & 952-106,EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-PJ0093',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C FOR LINE 29PL9-5,EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-PJ0124',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'ARRESTER,260KV,PH A,FOR 29PL9-5,29EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-PLA0015A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'ARRESTER,260KV,PH B,FOR 29PL9-5,29EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-PLA0015B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'ARRESTER,260KV,PH C,FOR 29PL9-5,29EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-PLA0015C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'ARRESTER,260KV,PH A,FOR 29PL9-6,29EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-PLA0033A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'ARRESTER,260KV,PH B,FOR 29PL9-6,29EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-PLA0033B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'ARRESTER,260KV,PH C,FOR 29PL9-6,29EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-PLA0033C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'ARRESTER,260KV,PH A,FOR 29PL9-16,29EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-PLA0108A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'ARRESTER,260KV,PH B,FOR 29PL9-16,29EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-PLA0108B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'ARRESTER,260KV,PH C,FOR 29PL9-16,29EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-PLA0108C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'ARRESTER,260KV,PH A,FOR 29PL9-17,29EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-PLA0109A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'ARRESTER,260KV,PH B,FOR 29PL9-17,29EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-PLA0109B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'ARRESTER,260KV,PH C,FOR 29PL9-17,29EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-PLA0109C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'ARRESTER,260KV,PH A,FOR 29PL9-2,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-PLA0180A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'ARRESTER,260KV,PH B,FOR 29PL9-2,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-PLA0180B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'ARRESTER,260KV,PH C,FOR 29PL9-2,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-PLA0180C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'ARRESTER,260KV,PH A,FOR 29PL9-4,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-PLA0181A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'ARRESTER,260KV,PH B,FOR 29PL9-4,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-PLA0181B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'ARRESTER,260KV,PH C,FOR 29PL9-4,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-PLA0181C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'ARRESTER,260KV,PH A,FOR 29PL9-1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-PLA0182A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'ARRESTER,260KV,PH B,FOR 29PL9-1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-PLA0182B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'ARRESTER,260KV,PH C,FOR 29PL9-1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-PLA0182C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'ARRESTER,260KV,PH A,FOR 29PL9-3,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-PLA0183A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'ARRESTER,260KV,PH B,FOR 29PL9-3,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-PLA0183B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'ARRESTER,260KV,PH C,FOR 29PL9-3,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-PLA0183C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,260KV,952-102 TO 29PL9-16,EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-PS0405',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,260KV,952-101 TO 29PL9-16,EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-PS0406',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,260KV,952-105 TO 29PL9-17,EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-PS0407',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,260KV,952-104 TO 29PL9-17,EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-PS0408',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,260KV,LINE 29PL9-16 IN 29EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-PS0409',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SWITCH,260KV,LINE 29PL9-17 IN 29EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-PS0410',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CVT,260KV,PH A,FOR LINE 29PL9-6,29EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-PT0178A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CVT,260KV,PH B,FOR LINE 29PL9-6,29EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-PT0178B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CVT,260KV,PH C,FOR LINE 29PL9-6,29EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-PT0178C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CVT,260KV,PH A,LINE 29PL9-16,29EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-PT0418A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CVT,260KV,PH B,LINE 29PL9-16,29EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-PT0418B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CVT,260KV,PH C,LINE 29PL9-16,29EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-PT0418C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CVT,260KV,PH A,LINE 29PL9-17,29EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-PT0419A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CVT,260KV,PH B,LINE 29PL9-17,29EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-PT0419B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CVT,260KV,PH C,LINE 29PL9-17,29EDD1X',N'OS1-P029-MAIN-SEG-EDD001-SEG-PT0419C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CHARGER BATTERY #1,125VDC IN 41RA-1631',N'OS1-P029-MAIN-SEG-EDD001-SEG-PU0004',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'CHARGER BATTERY #2,125VDC IN 41RA-1631',N'OS1-P029-MAIN-SEG-EDD001-SEG-PU0005',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SSVT,72KV,PH A,FROM BUS N72B1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-PVT1A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SSVT,72KV,PH B,FROM BUS N72B1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-PVT1B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SSVT,72KV,PH C,FROM BUS N72B1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-PVT1C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SSVT,72KV,PH A,FROM BUS X72B1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-PVT2A',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SSVT,72KV,PH B,FROM BUS X72B1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-PVT2B',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'SSVT,72KV,PH C,FROM BUS X72B1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-PVT2C',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R1,S152,29PL9-2,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R1',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R10,LINE 29PL9-3,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R10',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R11,S752 & S952,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R11',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R12,S852 & S1052,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R12',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R13,S952 & RAS,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R13',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R14,S1052 & IMS,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R14',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R15,BUS N260B1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R15',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R16,BUS X260B1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R16',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R17,BUS N260B2,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R17',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R18,BUS W260B1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R18',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R19,BUS X260B2,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R19',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R2,S252,29PL9-2,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R2',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R20,DISTRIBUTION,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R20',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R21,S1152,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R21',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R22,S1152 & S1252,EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R22',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R23,LINE 29PL6-6,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R23',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R24,S1352,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R24',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R25,LINE 6L32,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R25',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R26,S1352 & S1452,EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R26',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R27,LINE 29PL6-22,EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R27',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R28,S1552,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R28',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R29,S1552 & S1652,EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R29',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R3,LINE 29PL9-2,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R3',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R30,LINE 29PL6-4,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R30',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R31,S1752,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R31',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R32,LINE 29PL6-5,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R32',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R33,S952 S1752 S1852',N'OS1-P029-MAIN-SEG-EDD001-SEG-R33',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R34,LINE 29PL6-3,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R34',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R35,BUS N72B1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R35',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R36,BUS X72B1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R36',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R37,XFMR T1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R37',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R38,XFMR T1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R38',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R39,XFMR T2,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R39',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R4,S352,29PL9-4,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R4',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R40,XFMR T2,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R40',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,SCADA R41,HMI INVERTER,EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R41',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,SCADA R42,SCADA,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R42',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,SCADA R43,& TELECOM,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R43',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,FAULT RECORDER R49,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R49',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R5,LINE 29PL9-4,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R5',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R6,S152 & S452,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R6',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R7,S552,29PL9-1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R7',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R8,LINE 29PL9-1,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R8',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'PANEL,125VDC,P&C R9,S652,29PL9-3,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-R9',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'XFMR,260KV/72KV,T1,SOUTH BUS,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-T1',1000,7,'en';
EXEC dbo.FunctionalLocationAddOrUndelete 6, N'XFMR,260KV/72KV,T2,NORTH BUS,29EDD1',N'OS1-P029-MAIN-SEG-EDD001-SEG-T2',1000,7,'en';

IF EXISTS (SELECT * FROM sysobjects WHERE type = 'P' AND name = 'FunctionalLocationAddOrUndelete')
	BEGIN
		DROP PROCEDURE [dbo].FunctionalLocationAddOrUndelete
	END
GO

UPDATE dbo.FunctionalLocation SET Description = N'72KV SUBSTATION SKID FOR OPP UNIT "B"', PlantId = 1000 where FullHierarchy = N'OS1-P029-EXTD-SEG-EDD009' and SiteId = 6
UPDATE dbo.FunctionalLocation SET Description = N'OPRE PREPARATION PLANT UNIT "C"', PlantId = 1000 where FullHierarchy = N'OS1-P029-MAIN-SEG-EDD010' and SiteId = 6
UPDATE dbo.FunctionalLocation SET Description = N'XFMR,25KV/480V,FEEDS EHT BLDG 41RA-729', PlantId = 1000 where FullHierarchy = N'OS1-P029-UPGD-SEG-EDD023-SEG-PT0055' and SiteId = 6
UPDATE dbo.FunctionalLocation SET Description = N'XFMR,25KV/480-277V,FEEDS EHT BLDG 66RA-7', PlantId = 1000 where FullHierarchy = N'OS1-P029-UPGD-SEG-EDD069-SEG-PT0301' and SiteId = 6
UPDATE dbo.FunctionalLocation SET Description = N'XFMR,25KV/480V,FEEDS EHT BLDG 41RA-1624', PlantId = 1000 where FullHierarchy = N'OS1-P029-UPGD-SEG-EDD095-SEG-PT0134' and SiteId = 6
GO



GO

