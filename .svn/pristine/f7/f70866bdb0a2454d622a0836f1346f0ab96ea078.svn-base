BEGIN TRANSACTION
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', null, null, null, null, N'EDMONTON REFINERY', N'ED1', 0, null,0, null, 1, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A001', null, null, null, N'HEAVY OILS', N'ED1-A001', 0, null,0, null, 2, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A001', N'IFST', null, null, N'INFRASTRUCTURE', N'ED1-A001-IFST', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A001', N'U007', null, null, N'VACUUM', N'ED1-A001-U007', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A001', N'U008', null, null, N'FCCU', N'ED1-A001-U008', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A001', N'U009', null, null, N'UNSATURATE GAS', N'ED1-A001-U009', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A001', N'U011', null, null, N'BUTAMER', N'ED1-A001-U011', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A001', N'U012', null, null, N'ALKYLATION', N'ED1-A001-U012', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A001', N'U013', null, null, N'COKER', N'ED1-A001-U013', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A001', N'U021', null, null, N'INTERCONNECTING PIPING', N'ED1-A001-U021', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A001', N'U069', null, null, N'DELAYED COKER', N'ED1-A001-U069', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A002', null, null, null, N'LIGHT OILS', N'ED1-A002', 0, null,0, null, 2, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A002', N'IFST', null, null, N'INFRASTRUCTURE', N'ED1-A002-IFST', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A002', N'U001', null, null, N'CRUDE', N'ED1-A002-U001', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A002', N'U002', null, null, N'NAPHTHA HYRDROTREATER', N'ED1-A002-U002', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A002', N'U003', null, null, N'AVIATION GASOLINE', N'ED1-A002-U003', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A002', N'U004', null, null, N'SATURATE GAS', N'ED1-A002-U004', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A002', N'U005', null, null, N'PLATFORMER', N'ED1-A002-U005', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A002', N'U006', null, null, N'REFORMER', N'ED1-A002-U006', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A002', N'U010', null, null, N'DISTILLATE DEWAX', N'ED1-A002-U010', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A002', N'U017', null, null, N'CONDENSATE', N'ED1-A002-U017', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A002', N'U021', null, null, N'INTERCONNECTING PIPING', N'ED1-A002-U021', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A002', N'U061', null, null, N'SOUR CRUDE & VACUUM', N'ED1-A002-U061', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A003', null, null, null, N'SYNTHETIC CRUDE', N'ED1-A003', 0, null,0, null, 2, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A003', N'IFST', null, null, N'INFRASTRUCTURE', N'ED1-A003-IFST', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A003', N'U021', null, null, N'INTERCONNECTING PIPING', N'ED1-A003-U021', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A003', N'U051', null, null, N'SYNTHETIC CRUDE FRACTIONATOR', N'ED1-A003-U051', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A003', N'U052', null, null, N'HYDROCRACKER', N'ED1-A003-U052', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A003', N'U053', null, null, N'HYDROGEN', N'ED1-A003-U053', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A003', N'U054', null, null, N'ISOMERIZATION', N'ED1-A003-U054', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A003', N'U055', null, null, N'PSA INSTRUMENTATION', N'ED1-A003-U055', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A003', N'U063', null, null, N'GASOIL DISTILLATE HYDROTREATER', N'ED1-A003-U063', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A004', null, null, null, N'UTILITIES', N'ED1-A004', 0, null,0, null, 2, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A004', N'IFST', null, null, N'INFRASTRUCTURE', N'ED1-A004-IFST', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A004', N'U014', null, null, N'AMINE', N'ED1-A004-U014', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A004', N'U015', null, null, N'SULPHUR', N'ED1-A004-U015', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A004', N'U019', null, null, N'FLARE', N'ED1-A004-U019', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A004', N'U021', null, null, N'INTERCONNECTING PIPING', N'ED1-A004-U021', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A004', N'U025', null, null, N'CHEMICAL HANDLING', N'ED1-A004-U025', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A004', N'U031', null, null, N'STEAM AND AIR', N'ED1-A004-U031', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A004', N'U032', null, null, N'COOLING WATER', N'ED1-A004-U032', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A004', N'U033', null, null, N'FIRE WATER', N'ED1-A004-U033', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A004', N'U034', null, null, N'WASTER WATER HANDLING', N'ED1-A004-U034', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A004', N'U065', null, null, N'SOUR WATER STRIPPING', N'ED1-A004-U065', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A004', N'U066', null, null, N'AMINE', N'ED1-A004-U066', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A004', N'U067', null, null, N'SULPHUR RECOVERY', N'ED1-A004-U067', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A004', N'U068', null, null, N'STEAM', N'ED1-A004-U068', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A005', null, null, null, N'PUMPING & SHIPPING', N'ED1-A005', 0, null,0, null, 2, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A005', N'IFST', null, null, N'INFRASTRUCTURE', N'ED1-A005-IFST', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A005', N'U020', null, null, N'TANKAGE', N'ED1-A005-U020', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A005', N'U021', null, null, N'INTERCONNECTING PIPING', N'ED1-A005-U021', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A005', N'U022', null, null, N'PIPELINE SHIPPING', N'ED1-A005-U022', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A005', N'U023', null, null, N'LOADING', N'ED1-A005-U023', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A005', N'U024', null, null, N'PRODUCT BLENDING', N'ED1-A005-U024', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A006', null, null, null, N'GENERAL', N'ED1-A006', 0, null,0, null, 2, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A006', N'IFST', null, null, N'INFRASTRUCTURE', N'ED1-A006-IFST', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A006', N'U030', null, null, N'ELECTRICAL DISTRIBUTION SYSTEM', N'ED1-A006-U030', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A006', N'U049', null, null, N'CONTROL SYSTEMS', N'ED1-A006-U049', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A006', N'U071', null, null, N'GENERAL YARD MAINTENANCE', N'ED1-A006-U071', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A006', N'U072', null, null, N'AUTOMOTIVE', N'ED1-A006-U072', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A006', N'U073', null, null, N'MAINTENANCE NON FLEET', N'ED1-A006-U073', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A006', N'U079', null, null, N'MAINTENANCE/CAPITAL', N'ED1-A006-U079', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A006', N'U080', null, null, N'PLANT FIRE & SAFETY', N'ED1-A006-U080', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A006', N'U082', null, null, N'EMPLOYEE RELATIONS', N'ED1-A006-U082', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A006', N'U085', null, null, N'MANPOWER DEVELOPMENT', N'ED1-A006-U085', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A006', N'U090', null, null, N'ENGINEERING', N'ED1-A006-U090', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A006', N'U100', null, null, N'CONTROL SYSTEMS', N'ED1-A006-U100', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A006', N'U200', null, null, N'OFFSITE FACILITIES', N'ED1-A006-U200', 0, null,0, null, 3, 702)
INSERT INTO [dbo].[FunctionalLocation] (SiteId, Division, [Section], Unit, Equipment1, Equipment2, [Description], FullHierarchy, OutOfService, UnitId, Deleted, ParentId, [Level], PlantId) VALUES (8, N'ED1', N'A006', N'U300', null, null, N'OVERALL REFINERY', N'ED1-A006-U300', 0, null,0, null, 3, 702)
COMMIT TRANSACTION
GO

-- ------------------------------------------------------------------------------------

INSERT INTO ShiftFunctionalLocation (ShiftId, FunctionalLocationId)
select s.id, floc.id 
from functionallocation floc
cross join shift s
where s.SiteId = 8
and floc.division = 'ED1' 
and floc.level = 2;

go

-- ------------------------------------------------------------------------------------

insert into BusinessCategoryFLOCAssociation 
(BusinessCategoryId, FunctionalLocationId, LastModifiedUserId, LastModifiedDateTime)
select bc.Id, floc.Id, -1, GetDate()
from FunctionalLocation floc cross join BusinessCategory bc
where [Level] = 1
and Division = 'ED1';

go


-- ------------------------------------------------------------------------------------

SET IDENTITY_INSERT commentcategory ON;

insert into commentcategory (id, name, logguidelines, isdefaultcategory, deleted)
values (8, 'General Comments', null, 1, 0);

SET IDENTITY_INSERT commentcategory ON;

insert into CommentCategoryFunctionalLocation
select 8, id from FunctionalLocation where FullHierarchy = 'ED1';

go


-------------------------------------------------
---  Insert Operational Modes for each Unit   ---
-------------------------------------------------

BEGIN TRANSACTION
INSERT INTO FunctionalLocationOperationalMode
( UnitId, OperationalModeId, AvailabilityReasonId, LastModifiedDateTime)
(
    Select
        FunctionalLocation.Id,
        0,
        0,
        GETDATE()
    FROM
        FunctionalLocation
    WHERE
		SiteId = 8 
		AND Level = 3
		AND NOT EXISTS(SELECT UnitID FROM FunctionalLocationOperationalMode WHERE UnitId = FunctionalLocation.Id)
)
COMMIT TRANSACTION
GO



-------------------------------------------
---  Update UnitId for Unit Level Floc  ---
-------------------------------------------
BEGIN TRANSACTION
update 
	FunctionalLocation
set 
	UnitId = Id
where 
	SiteId = 8 
	AND Level = 3
	and UnitId IS NULL
COMMIT TRANSACTION	
GO

-------------------------------------------------
---  Update UnitId for Equipment1 Level Floc  ---
-------------------------------------------------
BEGIN TRANSACTION
update fl1
set 
	fl1.UnitId = fl2.UnitId
from 
	FunctionalLocation fl1,
	FunctionalLocation fl2
where 
	fl1.SiteId = 8 
	AND fl1.Level = 4
	and fl1.UnitId IS NULL
	and fl2.Level = 3
	and fl1.Siteid = fl2.SiteId
	and fl2.Division = fl1.Division
	and fl2.Section = fl1.Section
	and fl2.Unit = fl1.Unit
COMMIT TRANSACTION	
GO

-------------------------------------------------
---  Update UnitId for Equipment2 Level Floc  ---
-------------------------------------------------
BEGIN TRANSACTION
update fl1
set 
	fl1.UnitId = fl2.Id
from 
	FunctionalLocation fl1,
	FunctionalLocation fl2
where 
	fl1.SiteId = 8 
	AND fl1.Level = 5
	and fl1.UnitId IS NULL
	and fl2.Level = 3
	and fl1.SiteId = fl2.SiteId
	and fl2.Division = fl1.Division
	and fl2.Section = fl1.Section
	and fl2.Unit = fl1.Unit
COMMIT TRANSACTION
GO

-----------------------------------------------
-- Update Parent Id for Section Level Floc  ---
-----------------------------------------------
BEGIN TRANSACTION
UPDATE FunctionalLocation
SET
    ParentId = (
        SELECT DivisionFloc.id
        FROM
            FunctionalLocation DivisionFloc
        WHERE
            DivisionFloc.[Level] = 1
            AND DivisionFloc.Division = FunctionalLocation.Division)
WHERE 
	FunctionalLocation.SiteId = 8 AND
    FunctionalLocation.ParentId IS NULL AND
    FunctionalLocation.[Level] = 2 
COMMIT TRANSACTION    
GO

--------------------------------------------
-- Update Parent Id for Unit Level Floc  ---
--------------------------------------------
BEGIN TRANSACTION
UPDATE FunctionalLocation
SET
    ParentId = (
        SELECT SectionFloc.id
        FROM
            FunctionalLocation SectionFloc
        WHERE
            SectionFloc.[Level] = 2
            AND SectionFloc.[Division] = FunctionalLocation.Division
            AND SectionFloc.Section = FunctionalLocation.Section)
WHERE 
	FunctionalLocation.SiteId = 8 AND
    FunctionalLocation.ParentId IS NULL AND	
    FunctionalLocation.[Level] = 3
COMMIT TRANSACTION
GO

--------------------------------------------------
-- Update Parent Id for Equipment1 Level Floc  ---
--------------------------------------------------
BEGIN TRANSACTION
UPDATE FunctionalLocation
SET ParentId = ( UnitId ) 
WHERE 
	FunctionalLocation.SiteId = 8 AND
	FunctionalLocation.[Level] = 4
COMMIT TRANSACTION
GO

--------------------------------------------------
-- Update Parent Id for Equipment2 Level Floc  ---
--------------------------------------------------
BEGIN TRANSACTION
UPDATE FunctionalLocation
SET
    ParentId = (
        SELECT Equipment1Floc.id
        FROM
            FunctionalLocation Equipment1Floc
        WHERE
            Equipment1Floc.UnitId = FunctionalLocation.UnitId
            AND Equipment1Floc.Equipment1 = FunctionalLocation.Equipment1
            AND Equipment1Floc.[Level] = 4)
WHERE 
	FunctionalLocation.SiteId = 8 AND
    FunctionalLocation.ParentId IS NULL AND	
    FunctionalLocation.[Level] = 5
COMMIT TRANSACTION
GO


--------------------------------------------------
-- Update Ancestor Table                       ---
--------------------------------------------------

-- Child Level 2, Parent Level 1
INSERT INTO FunctionalLocationAncestor ([Id], [AncestorId]) (
select c.id, a.id from FunctionalLocation c,
functionallocation a
where 
a.siteid = 8
and a.siteid = c.siteid
and c.level = 2
and c.level > a.level
and CHARINDEX(a.FullHierarchy, c.FullHierarchy) = 1
and NOT EXISTS(select id from FunctionalLocationAncestor where id = c.id and ancestorid = a.id)
)

go

-- Child Level 3, Parent Level 1 and 2
INSERT INTO FunctionalLocationAncestor ([Id], [AncestorId]) (
select c.id, a.id from FunctionalLocation c,
functionallocation a
where 
a.siteid = 8
and a.siteid = c.siteid
and c.level = 3
and c.level > a.level
and CHARINDEX(a.FullHierarchy, c.FullHierarchy) = 1
and NOT EXISTS(select id from FunctionalLocationAncestor where id = c.id and ancestorid = a.id)
)

go

-- Child Level 4, Parent Level 3
INSERT INTO FunctionalLocationAncestor ([Id], [AncestorId]) (
select c.id, c.parentid from FunctionalLocation c
where 
c.siteid = 8
and c.level = 4
and parentid is not null
and NOT EXISTS(select id from FunctionalLocationAncestor where id = c.id and ancestorid = c.parentid)
)

go

-- Child Level 4, Parent Level 1 and 2
INSERT INTO FunctionalLocationAncestor ([Id], [AncestorId]) (
select c.id, a.id from FunctionalLocation c,
functionallocation a
where 
a.siteid = 8
and a.siteid = c.siteid
and c.level = 4
and a.level <= 2
and CHARINDEX(a.FullHierarchy, c.FullHierarchy) = 1
and NOT EXISTS(select id from FunctionalLocationAncestor where id = c.id and ancestorid = a.id)
)

go

-- Child Level 5, Parent Level 4
INSERT INTO FunctionalLocationAncestor ([Id], [AncestorId]) (
select c.id, c.parentid from FunctionalLocation c
where 
c.siteid = 8
and c.level = 5
and parentid is not null
and NOT EXISTS(select id from FunctionalLocationAncestor where id = c.id and ancestorid = c.parentid)
)

go

-- Child Level 5, Parent Level 3
INSERT INTO FunctionalLocationAncestor ([Id], [AncestorId]) (
select c.id, c.unitid from FunctionalLocation c
where 
c.siteid = 8
and c.level = 5
and unitid is not null
and NOT EXISTS(select id from FunctionalLocationAncestor where id = c.id and ancestorid = c.unitid)
)

go

-- Child Level 5, Parent Level 1 and 2
INSERT INTO FunctionalLocationAncestor ([Id], [AncestorId]) (
select c.id, a.id from FunctionalLocation c,
functionallocation a
where 
c.siteid = 8
and a.siteid = c.siteid
and c.level = 5
and a.level <= 2
and CHARINDEX(a.FullHierarchy, c.FullHierarchy) = 1
and NOT EXISTS(select id from FunctionalLocationAncestor where id = c.id and ancestorid = a.id)
)


go
GO
