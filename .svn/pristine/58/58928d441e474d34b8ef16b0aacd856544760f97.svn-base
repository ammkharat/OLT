if exists (select * from dbo.sysobjects where id = object_id(N'[dbo].[InsertWorkPermitHistory]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
drop procedure [dbo].[InsertWorkPermitHistory]

GO

CREATE Procedure [dbo].[InsertWorkPermitHistory]
(
    @Id bigint,
    @PermitNumber varchar(50) = NULL,
    @LastModifiedDate datetime,
    @LastModifiedUserId bigint = NULL,
    @ApprovedByUserId bigint = NULL,
    @SourceId int,

    @SpecialRescueOrFallNotApplicable bit,
    @SpecialRescueOrFallOtherDescription varchar(50)= NULL,
    @SpecialRescueOrFallRescueDevice bit,
    @SpecialRescueOrFallYoYo bit,
    @SpecialRescueOrFallLifeline bit,
    @SpecialRescueOrFallBodyHarness bit,
	
	@SpecialFallOtherDescription varchar(50) = NULL,
	@SpecialFallRestraint bit,
	@SpecialFallSelfRetractingDevice bit,
	@SpecialFallTieoffRequired bit = NULL,

    @SpecialHandProtectionNotApplicable bit,
    @SpecialHandProtectionOtherDescription varchar(50)= NULL,
    @SpecialHandProtectionChemicalGloves bit,
    @SpecialHandProtectionLeather bit,
    @SpecialHandProtectionWelding bit,
    @SpecialHandProtectionHighVoltage bit,
    @SpecialHandProtectionPVC bit,
    @SpecialHandProtectionNitrile bit,
    @SpecialHandProtectionNaturalRubber bit,
    @SpecialHandProtectionChemicalNeprene bit,

    @SpecialProtectiveFootwearNotApplicable bit,
    @SpecialProtectiveFootwearOtherDescription varchar(50)= NULL,
    @SpecialProtectiveFootwearToeGuard bit,
    @SpecialProtectiveFootwearChemicalImperviousBoots bit,
    @SpecialProtectiveFootwearMetatarsalGuard bit,

    @SpecialProtectiveClothingTypeNotApplicable bit,
    @SpecialProtectiveClothingTypeOtherDescripton varchar(50)= NULL,
    @SpecialProtectiveClothingTypeTyvekSuit bit,
	@SpecialProtectiveClothingTypeKapplerSuit bit,
	@SpecialProtectiveClothingTypeElectricalFlashGear bit,
	@SpecialProtectiveClothingTypeCorrosiveClothing bit,
    @SpecialProtectiveClothingTypeCausticWear bit,
	@SpecialProtectiveClothingTypePaperCoveralls bit,
    @SpecialProtectiveClothingTypeAcidClothingTypeID int = NULL,
    @SpecialProtectiveClothingTypeAcidClothing bit,
    @SpecialProtectiveClothingTypeRainPants bit,
    @SpecialProtectiveClothingTypeRainCoat bit,

    @SpecialEyeOrFaceProtectionNotApplicable bit,
    @SpecialEyeOrFaceProtectionOtherDescription varchar(50)= NULL,
    @SpecialEyeOrFaceProtectionFaceshield bit,
    @SpecialEyeOrFaceProtectionGoggles bit,

    @RespitoryProtectionRequirementsNotApplicable bit,
    @RespitoryProtectionRequirementsRespiratoryCartridgeTypeDescription varchar(50)= NULL,
    @RespitoryProtectionRequirementsRespiratoryCartridgeTypeId bigint= NULL,
    @RespitoryProtectionRequirementsOtherDescription varchar(50)= NULL,
    @RespitoryProtectionRequirementsAirHood bit,
    @RespitoryProtectionRequirementsDustMask bit,
    @RespitoryProtectionRequirementsFullFaceRespirator bit,
    @RespitoryProtectionRequirementsHalfFaceRespirator bit,
    @RespitoryProtectionRequirementsSCBA bit,
    @RespitoryProtectionRequirementsAirCartOrAirLine bit,

    @FireConfinedSpaceNotApplicable bit,
    @FireConfinedSpaceOtherDescription varchar(50)= NULL,
    @FireConfinedSpaceWatchmen bit,
    @FireConfinedSpaceHoleWatchNumber varchar(50)= NULL,
    @FireConfinedSpaceFireWatchNumber varchar(50)= NULL,
    @FireConfinedSpaceSpotterNumber varchar(50)= NULL,
    @FireConfinedSpaceSteamHose bit,
    @FireConfinedSpaceWaterHose bit,
    @FireConfinedSpaceSparkContainment bit,
    @FireConfinedSpaceFireResistantTarp bit,
    @FireConfinedSpaceC02Extinguisher bit,
    @FireConfinedSpace20ABCorDryChemicalExtinguisher bit,

    @GasTestConstantMonitoringRequired bit,
	@GasTestForkliftNotUsed bit,
    @GasTestTestTime datetime= NULL,
    @GasTestConfinedSpaceTestTime datetime= NULL,
    @GasTestSystemEntryTestTime datetime= NULL,
    @GasTestFrequencyOrDuration varchar(50)= NULL,

    @RadiationSealedSourceIsolationNumberOfSources int = NULL,
    @RadiationSealedSourceIsolationOpen bit,
    @RadiationSealedSourceIsolationLOTO bit,
    @RadiationSealedSourceIsolationNotApplicable bit,

    @JobSitePreparationLightingElectricalRequirementOtherDescription varchar(50)= NULL,
    @JobSitePreparationLightingElectricalRequirementGeneratorLights bit,
    @JobSitePreparationLightingElectricalRequirement110VWithGFCI bit,
    @JobSitePreparationLightingElectricalRequirementLowVoltage12V bit,
    @JobSitePreparationLightingElectricalRequirementNotApplicable bit,
    @JobSitePreparationAreaPreparationOtherDescription varchar(50)= NULL,
    @JobSitePreparationAreaPreparationPreopBoundaryRopeTape bit,
    @JobSitePreparationAreaPreparationRadiationRope bit,
    @JobSitePreparationAreaPreparationNonEssentialEvac bit,
    @JobSitePreparationAreaPreparationBarricade bit,
    @JobSitePreparationAreaPreparationNotApplicable bit,
    @JobSitePreparationVentilationMethodForced bit,
    @JobSitePreparationVentilationMethodLocalExhaust bit,
    @JobSitePreparationVentilationMethodNaturalDraft bit,
    @JobSitePreparationVentilationMethodNotApplicable bit,
    @JobSitePreparationSewerIsolationMethodOtherDescription varchar(50)= NULL,
    @JobSitePreparationSewerIsolationMethodBlindedOrBlanked bit,
    @JobSitePreparationSewerIsolationMethodPlugged bit,
    @JobSitePreparationSewerIsolationMethodSealedOrCovered bit,
    @JobSitePreparationSewerIsolationMethodNotApplicable bit,
    @JobSitePreparationPermitReceiverFieldOrEquipmentOrientation bit = NULL,
	@IsControlRoomContactedOrNot bit = NULL, --vibhor
	@Revalidation int =NULL,
    @JobSitePreparationPermitReceiverFieldOrEquipmentOrientationNotApplicable bit,
    @JobSitePreparationPermitReceiverRequiresOrientationComments varchar(400)= NULL,

    @JobSitePreparationVestedBuddySystemInEffect bit = NULL,
    @JobSitePreparationVestedBuddySystemInEffectNotApplicable bit,

    @JobSitePreparationSurroundingConditionsAffectOrContaminated bit = NULL,
    @JobSitePreparationSurroundingConditionsAffectOrContaminatedNotApplicable bit,
    @JobSitePreparationSurroundingConditionsAffectAreaComments varchar(400)= NULL,    

    @JobSitePreparationCriticalConditionRemainJobSite bit = NULL,
    @JobSitePreparationCriticalConditionRemainJobSiteNotApplicable bit,
    @JobSitePreparationCriticalConditionsComments varchar(400)= NULL,

    @JobSitePreparationWeldingGroundWireInTestArea bit = NULL,
    @JobSitePreparationWeldingGroundWireInTestAreaNotApplicable bit,
	@ControlRoomContactedNotApplicable bit, --vibhor
    @JobSitePreparationWeldingGroundWireNotWithinGasTestAreaComments varchar(400)= NULL,

    @JobSitePreparationBondingOrGroundingRequired bit = NULL,
    @JobSitePreparationBondingOrGroundingRequiredNotApplicable bit,
    @JobSitePreparationBondingGroundingNotRequiredComments varchar(400)= NULL,

    @JobSitePreparationFlowRequiredForJobNotApplicable bit = NULL,
    @JobSitePreparationFlowRequiredForJob bit = NULL,    
    @JobSitePreparationFlowRequiredComments varchar(400)= NULL,

    @EquipmentIsolationMethodOtherDescription varchar(50)= NULL,
    @EquipmentIsolationMethodLOTO bit,
    @EquipmentIsolationMethodMudderPlugs bit,
    @EquipmentIsolationMethodSeparation bit,
    @EquipmentIsolationMethodBlindedorBlanked bit,
    @EquipmentIsolationMethodBlockedIn bit,
    @EquipmentIsolationMethodCarBer bit,
    @EquipmentIsolationMethodNotApplicable bit,
    @EquipmentPreviousContentsOtherDescription varchar(50)= NULL,
    @EquipmentPreviousContentsH2S bit,
    @EquipmentPreviousContentsCaustic bit,
    @EquipmentPreviousContentsAcid bit,
    @EquipmentPreviousContentsHydrocarbon bit,
    @EquipmentPreviousContentsNotApplicable bit,
	@EquipmentAsbestosGasketsNotApplicable bit,
	@EquipmentAsbestosGaskets bit = NULL,
    @EquipmentConditionPurgedDescription varchar(50)= NULL,
    @EquipmentConditionPurged bit,
    @EquipmentConditionPurgedN2 bit,
    @EquipmentConditionPurgedSteamed bit,
    @EquipmentConditionPurgedAir bit,    
    @EquipmentConditionNeutralized bit,
    @EquipmentConditionH20Washed bit,
    @EquipmentConditionVentilated bit,
    @EquipmentConditionCleaned bit,
    @EquipmentConditionDrained bit,
    @EquipmentConditionDepressured bit,
    @EquipmentConditionNotApplicable bit,
    @EquipmentConditionOtherDescription varchar(50)= NULL,
	@EquipmentConditionPurgedChecked bit, --vibhor
    @EquipmentIsOutOfService bit = NULL,
    @EquipmentInServiceComments varchar(400)= NULL,

	@EquipmentInAsbestosHazardPresentComments varchar(400)=NULL, --vibhor

	

    @EquipmentLeakingValves bit = NULL,
    @EquipmentLeakingValvesNotApplicable bit,
    @EquipmentLeakingValvesComments varchar(400)= NULL,
        
    @EquipmentStillContainsResidual bit = NULL,
    @EquipmentStillContainsResidualNotApplicable bit,
    @EquipmentStillContainsResidualComments varchar(400)= NULL,
    
    @ElectricTestBump bit = NULL,
    @ElectricTestBumpNotApplicable bit,
    @EquipmentNoElectricalTestBumpComments varchar(400)= NULL,    
    @ElectricIsolationMethodWiring bit,
    @ElectricIsolationMethodLOTO bit,
    @ElectricIsolationMethodNotApplicable bit,

    @EquipmentIsHazardousEnergyIsolationRequiredNotApplicable bit,
    @EquipmentIsHazardousEnergyIsolationRequired bit = NULL,
    @EquipmentLockOutMethodId bigint = NULL,
    @EquipmentLockOutMethodComments varchar(600) = NULL,
    @EquipmentEnergyIsolationPlanNumber varchar(100) = NULL,
    @EquipmentConditionsOfEIPSatisfied bit = NULL,
    @EquipmentConditionsOfEIPNotSatisfiedComments varchar(400) = NULL,

    @AsbestosHazardsConsideredNotApplicable bit,
    @AsbestosHazardsConsidered bit = NULL,

    @ToolsOtherToolsDescription varchar(50)= NULL,
    @ToolsWelder bit,
    @ToolsChemicals bit,
    @ToolsTorch bit,
    @ToolsPortLighting bit,
    @ToolsHotTapMachine bit,
    @ToolsTamper bit,
    @ToolsManlift bit,
    @ToolsHEPAVacuum bit,
    @ToolsForklift bit,
    @ToolsCompressor bit,
    @ToolsVehicle bit,
    @ToolsScaffolding bit,
    @ToolsLanda bit,
    @ToolsHeavyEquipment bit,
    @ToolsElectricTools bit,
    @ToolsCementSaw bit,
    @ToolsVacuumTruck bit,
    @ToolsJackhammer bit,
    @ToolsHandTools bit,
    @ToolsCraneOrCarrydeck bit,
    @ToolsAirTools bit,
    @CoAuthorizationRequired bit= NULL,
    @CommunicationByOtherDescription varchar(50)= NULL,
    @CoAuthorizationDescription varchar(50) = NULL,
    @CommunicationRadioColor varchar(20)= NULL,
    @CommunicationRadioChannelOrBand varchar(20)= NULL,
    @IsWorkPermitCommunicationNotApplicable bit,
    @CommunicationByRadio bit = NULL,
    @JobStepDescription VARCHAR(MAX) = NULL,
    @CraftOrTradeID bigint = NULL,
    @CraftOrTradeOther varchar(50) = NULL,
    @ContractorCompanyName varchar(50)= NULL,
    @ContactPersonnel varchar(50)= NULL,
    @AdditionalOtherFormsOrAssessmentsOrAuthorizations varchar(50)= NULL,
    @AdditionalMSDS bit,
    @AdditionalWaiverOrDeviation bit,
    @AdditionalWaiverOrDeviationDescription varchar(50)= NULL,
    @AdditionalBurnOrOpenFlameAssessment bit,
    @AdditionalBurnOrOpenFlameAssessmentDescription varchar(50)= NULL,
    @AdditionalElectrical bit,
    @AdditionalElectricalDescription varchar(50)= NULL,
    @AdditionalRoadClosure bit,
    @AdditionalAsbestosHandling bit,
    @AdditionalAsbestosHandlingDescription varchar(50)= NULL,
    @AdditionalPJSROrSafetyPause bit,
    @AdditionalBlankOrBlindLists bit,
    @AdditionalSpecialWasteDisposal bit,
    @AdditionalHotTap bit,
    @AdditionalExcavation bit,
    @AdditionalExcavationDescription varchar(50)= NULL,
    @AdditionalCriticalLift bit,
    @AdditionalCriticalLiftDescription varchar(50)= NULL,
    @AdditionalFlareEntry bit,
    @AdditionalCSEAssessmentOrAuthorization bit,
    @AdditionalCSEAssessmentOrAuthorizationDescription varchar(50)= NULL,
    @AdditionalRadiationApproval bit,
    @AdditionalOnlineLeakRepairForm bit,
	@AdditionalIsEnergizedElectricalForm bit,
	@AdditionalIsNotApplicable bit,

    @PermitRadiationSealed bit,
    @PermitRadiationRadiography bit,
	@PermitFreshAir bit, --vibhor
	@ControlRoomContacted bit, --vibhor
    @PermitAsbestos bit,
    @PermitExcavation bit,
    @PermitCriticalLift bit,
    @PermitSystemEntry bit,
    @PermitBurnOrOpenFlame bit,
    @PermitHotTap bit,
    @PermitVehicleEntry bit,
    @PermitElectricalWork bit,
    @PermitBreathingAirOrSCBA bit,
    @PermitConfinedSpaceEntry bit,
    @PermitInertConfinedSpaceEntry bit,
    @PermitLeadAbatement bit,
    @SpecialPrecautionsOrConsiderationsDescription VARCHAR(MAX)= NULL,
    @WorkOrderDescription VARCHAR(MAX)= NULL,
    @WorkPermitTypeClassificationId bigint,
    @WorkPermitTypeId bigint,
    @PermitValidDateTime datetime=NULL,
    @EndDateTime datetime=NULL,
    @StartDateTime datetime,
	@StartTimeNotApplicable bit,
    @StartAndOrEndTimesFinalized BIT,
    @WorkOrderNumber varchar(50)=NULL,
    @FunctionalLocationId bigint,
	@WorkAssignmentId bigint,
    @WorkPermitStatusId bigint,
    @SapOperationId bigint = NULL,
    @DocumentLinks varchar(MAX)=NULL,

	@PreExcavationAuthorization									bit,
@SuspendedWorkPlatform 										bit,
@HotTurnoverApproval 										bit,
@ConfinedSpaceEntryAuthorizationForm 						bit,
@PreExcavationAuthorizationForm 								bit,
@SupplementalJobSiteSignInForm 								bit,
@SystemEntryGasTestLogFrom 									bit,
@HeatStressMonitoringForm 									bit,
@CriticalLiftApprovalForm 									bit,
@PjsrSecondSection 											bit,
@DeviationRequestForm 										bit,
@RoadClosureform 											bit,
@RadiographyApprovalForm 									bit,
@ConfinedSpaceEntryTrackingLog 								bit,
@FlareLineChecklists 										bit,
@HotTurnoverApprovalForm 									bit,
@IndustrialHygieneAreaRealTimeSamplingForm 					bit,
@CraneSuspendedWorkPlatformChecklist 						bit,
@ConfinedSpaceEntryAuthorizationFormSecondSection 			bit,


    @GasTestElements varchar(2000)=NULL
)
AS

INSERT INTO WorkPermitHistory
(
    Id,
    LastModifiedDate,
    LastModifiedUserId,
    ApprovedByUserId,
    SourceId,

    SpecialRescueOrFallNotApplicable,
    SpecialRescueOrFallOtherDescription,
    SpecialRescueOrFallRescueDevice,
    SpecialRescueOrFallYoYo,
    SpecialRescueOrFallLifeline,
    SpecialRescueOrFallBodyHarness,
	
    SpecialHandProtectionNotApplicable,
    SpecialHandProtectionOtherDescription,
    SpecialHandProtectionChemicalGloves,
    SpecialHandProtectionLeather,
    SpecialHandProtectionWelding,
    SpecialHandProtectionHighVoltage,
    SpecialHandProtectionPVC,
    SpecialHandProtectionNitrile,
    SpecialHandProtectionNaturalRubber,
    SpecialHandProtectionChemicalNeprene,

    SpecialProtectiveFootwearNotApplicable,
    SpecialProtectiveFootwearOtherDescription,
    SpecialProtectiveFootwearToeGuard,
    SpecialProtectiveFootwearChemicalImperviousBoots,
    SpecialProtectiveFootwearMetatarsalGuard,

    SpecialProtectiveClothingTypeNotApplicable,
    SpecialProtectiveClothingTypeOtherDescripton,
    SpecialProtectiveClothingTypeTyvekSuit,
	SpecialProtectiveClothingTypeKapplerSuit,
	SpecialProtectiveClothingTypeElectricalFlashGear,
	SpecialProtectiveClothingTypeCorrosiveClothing,    
    SpecialProtectiveClothingTypeCausticWear,
	SpecialProtectiveClothingTypePaperCoveralls,
    SpecialProtectiveClothingTypeAcidClothingTypeID,
    SpecialProtectiveClothingTypeAcidClothing,
    SpecialProtectiveClothingTypeRainPants,
    SpecialProtectiveClothingTypeRainCoat,

    SpecialEyeOrFaceProtectionNotApplicable,
    SpecialEyeOrFaceProtectionOtherDescription,
    SpecialEyeOrFaceProtectionFaceshield,
    SpecialEyeOrFaceProtectionGoggles,

    RespitoryProtectionRequirementsNotApplicable,
    RespitoryProtectionRequirementsRespiratoryCartridgeTypeDescription,
    RespitoryProtectionRequirementsRespiratoryCartridgeTypeId,
    RespitoryProtectionRequirementsOtherDescription,
    RespitoryProtectionRequirementsAirHood,
    RespitoryProtectionRequirementsDustMask,
    RespitoryProtectionRequirementsFullFaceRespirator,
    RespitoryProtectionRequirementsHalfFaceRespirator,
    RespitoryProtectionRequirementsSCBA,
    RespitoryProtectionRequirementsAirCartOrAirLine,

    FireConfinedSpaceNotApplicable,
    FireConfinedSpaceOtherDescription,
    FireConfinedSpaceWatchmen,
    FireConfinedSpaceHoleWatchNumber,
    FireConfinedSpaceFireWatchNumber,    
    FireConfinedSpaceSpotterNumber,
    FireConfinedSpaceSteamHose,
    FireConfinedSpaceWaterHose,
    FireConfinedSpaceSparkContainment,
    FireConfinedSpaceFireResistantTarp,
    FireConfinedSpaceC02Extinguisher,
    FireConfinedSpace20ABCorDryChemicalExtinguisher,
    GasTestConstantMonitoringRequired,
    GasTestTestTime,
    GasTestConfinedSpaceTestTime,
    GasTestSystemEntryTestTime,
    GasTestFrequencyOrDuration,
    RadiationSealedSourceIsolationNumberOfSources,
    RadiationSealedSourceIsolationOpen,
    RadiationSealedSourceIsolationLOTO,
    RadiationSealedSourceIsolationNotApplicable,
    JobSitePreparationLightingElectricalRequirementOtherDescription,
    JobSitePreparationLightingElectricalRequirementGeneratorLights,
    JobSitePreparationLightingElectricalRequirement110VWithGFCI,
    JobSitePreparationLightingElectricalRequirementLowVoltage12V,
    JobSitePreparationLightingElectricalRequirementNotApplicable,
    JobSitePreparationAreaPreparationOtherDescription,
    JobSitePreparationAreaPreparationPreopBoundaryRopeTape,
    JobSitePreparationAreaPreparationRadiationRope,
    JobSitePreparationAreaPreparationNonEssentialEvac,
    JobSitePreparationAreaPreparationBarricade,
    JobSitePreparationAreaPreparationNotApplicable,
    JobSitePreparationVentilationMethodForced,
    JobSitePreparationVentilationMethodLocalExhaust,
    JobSitePreparationVentilationMethodNaturalDraft,
    JobSitePreparationVentilationMethodNotApplicable,
    JobSitePreparationSewerIsolationMethodOtherDescription,
    JobSitePreparationSewerIsolationMethodBlindedOrBlanked,
    JobSitePreparationSewerIsolationMethodPlugged,
    JobSitePreparationSewerIsolationMethodSealedOrCovered,
    JobSitePreparationSewerIsolationMethodNotApplicable,
    JobSitePreparationPermitReceiverFieldOrEquipmentOrientation,
	IsControlRoomContactedOrNot, --vibhor
	Revalidation,
    JobSitePreparationPermitReceiverFieldOrEquipmentOrientationNotApplicable,
    JobSitePreparationVestedBuddySystemInEffect,
    JobSitePreparationVestedBuddySystemInEffectNotApplicable,
    JobSitePreparationSurroundingConditionsAffectOrContaminated,
    JobSitePreparationSurroundingConditionsAffectOrContaminatedNotApplicable,
    JobSitePreparationCriticalConditionRemainJobSite,
    JobSitePreparationCriticalConditionRemainJobSiteNotApplicable,
    JobSitePreparationWeldingGroundWireInTestArea,
    JobSitePreparationWeldingGroundWireInTestAreaNotApplicable,
    JobSitePreparationBondingOrGroundingRequired,
    JobSitePreparationBondingOrGroundingRequiredNotApplicable,
	ControlRoomContactedNotApplicable, --vibhor
    JobSitePreparationFlowRequiredForJobNotApplicable,
    JobSitePreparationFlowRequiredForJob,
    EquipmentIsolationMethodOtherDescription,
    EquipmentIsolationMethodLOTO,
    EquipmentIsolationMethodMudderPlugs,
    EquipmentIsolationMethodSeparation,
    EquipmentIsolationMethodBlindedorBlanked,
    EquipmentIsolationMethodBlockedIn,
    EquipmentIsolationMethodCarBer,
    EquipmentIsolationMethodNotApplicable,
    EquipmentPreviousContentsOtherDescription,
    EquipmentPreviousContentsH2S,
    EquipmentPreviousContentsCaustic,
    EquipmentPreviousContentsAcid,
    EquipmentPreviousContentsHydrocarbon,
    EquipmentPreviousContentsNotApplicable,
	EquipmentAsbestosGasketsNotApplicable,
	EquipmentAsbestosGaskets,
    EquipmentConditionPurgedDescription,
    EquipmentConditionPurged,
    EquipmentConditionPurgedN2,
    EquipmentConditionPurgedSteamed,
    EquipmentConditionPurgedAir,
    EquipmentConditionNeutralized,
    EquipmentConditionH20Washed,
    EquipmentConditionVentilated,
    EquipmentConditionCleaned,
    EquipmentConditionDrained,
    EquipmentConditionDepressured,
    EquipmentConditionNotApplicable,
    EquipmentConditionOtherDescription,
	EquipmentConditionPurgedChecked, --vibhor
    EquipmentIsOutOfService,
    EquipmentLeakingValves,
    EquipmentLeakingValvesNotApplicable,    
    EquipmentStillContainsResidual,
    EquipmentStillContainsResidualNotApplicable,
    ElectricTestBump,
    ElectricTestBumpNotApplicable,
    ElectricIsolationMethodWiring,
    ElectricIsolationMethodLOTO,
    ElectricIsolationMethodNotApplicable,
    EquipmentIsHazardousEnergyIsolationRequiredNotApplicable,
    EquipmentIsHazardousEnergyIsolationRequired,
    EquipmentLockOutMethodId,
    EquipmentLockOutMethodComments,
    EquipmentEnergyIsolationPlanNumber,
    EquipmentConditionsOfEIPSatisfied,
    EquipmentConditionsOfEIPNotSatisfiedComments,
    AsbestosHazardsConsideredNotApplicable,
    AsbestosHazardsConsidered,
    ToolsOtherToolsDescription,
    ToolsWelder,
    ToolsChemicals,
    ToolsTorch,
    ToolsPortLighting,
    ToolsHotTapMachine,
    ToolsTamper,
    ToolsManlift,
    ToolsHEPAVacuum,
    ToolsForklift,
    ToolsCompressor,
    ToolsVehicle,
    ToolsScaffolding,
    ToolsLanda,
    ToolsHeavyEquipment,
    ToolsElectricTools,
    ToolsCementSaw,
    ToolsVacuumTruck,
    ToolsJackhammer,
    ToolsHandTools,
    ToolsCraneOrCarrydeck,
    ToolsAirTools,
    CoAuthorizationDescription,
    CoAuthorizationRequired,
    CommunicationByOtherDescription,
    CommunicationRadioColor,
    CommunicationRadioChannelOrBand,
    IsWorkPermitCommunicationNotApplicable,
    CommunicationByRadio,
    JobStepDescription,
    CraftOrTradeOther,
    CraftOrTradeID,
    ContractorCompanyName,
    ContactPersonnel,
    AdditionalOtherFormsOrAssessmentsOrAuthorizations,
    AdditionalMSDS,
    AdditionalWaiverOrDeviation,
    AdditionalWaiverOrDeviationDescription,
    AdditionalBurnOrOpenFlameAssessment,
    AdditionalBurnOrOpenFlameAssessmentDescription,
    AdditionalElectrical,
    AdditionalElectricalDescription,
    AdditionalRoadClosure,
    AdditionalAsbestosHandling,
    AdditionalAsbestosHandlingDescription,
    AdditionalPJSROrSafetyPause,
    AdditionalBlankOrBlindLists,
    AdditionalSpecialWasteDisposal,
    AdditionalHotTap,
    AdditionalExcavation,
    AdditionalExcavationDescription,
    AdditionalCriticalLift,
    AdditionalCriticalLiftDescription,
    AdditionalFlareEntry,
    AdditionalCSEAssessmentOrAuthorization,
    AdditionalCSEAssessmentOrAuthorizationDescription,
    AdditionalRadiationApproval,
    AdditionalOnlineLeakRepairForm,

    PermitRadiationSealed,
    PermitRadiationRadiography,
    PermitAsbestos,
    PermitExcavation,
    PermitCriticalLift,
    PermitSystemEntry,
	PermitFreshAir, --vibhor
	ControlRoomContacted, --vibhor
    PermitBurnOrOpenFlame,
    PermitHotTap,
    PermitVehicleEntry,
    PermitElectricalWork,
    PermitBreathingAirOrSCBA,
    PermitConfinedSpaceEntry,
    PermitInertConfinedSpaceEntry,
    PermitLeadAbatement,

    SpecialPrecautionsOrConsiderationsDescription,
    WorkOrderDescription,
    WorkPermitTypeClassificationId,
    WorkPermitTypeId,
    PermitValidDateTime,
    EndDateTime,
    StartDateTime,
    StartAndOrEndTimesFinalized,
    WorkOrderNumber,
    PermitNumber,
    FunctionalLocationId,
	WorkAssignmentId,
    WorkPermitStatusId,
    EquipmentStillContainsResidualComments,
    EquipmentInServiceComments,
    EquipmentNoElectricalTestBumpComments,
    EquipmentLeakingValvesComments,
    JobSitePreparationFlowRequiredComments,
    JobSitePreparationBondingGroundingNotRequiredComments,
	EquipmentInAsbestosHazardPresentComments, --vibhor
	
    JobSitePreparationWeldingGroundWireNotWithinGasTestAreaComments,
    JobSitePreparationSurroundingConditionsAffectAreaComments,
    JobSitePreparationPermitReceiverRequiresOrientationComments,
    JobSitePreparationCriticalConditionsComments,    
    SapOperationId,
    DocumentLinks,

	
PreExcavationAuthorization						,
SuspendedWorkPlatform 							,
HotTurnoverApproval 							,
ConfinedSpaceEntryAuthorizationForm 			,
PreExcavationAuthorizationForm 					,
SupplementalJobSiteSignInForm 					,
SystemEntryGasTestLogFrom 						,
HeatStressMonitoringForm 						,
CriticalLiftApprovalForm 						,
PjsrSecondSection 								,
DeviationRequestForm 							,
RoadClosureform 								,
RadiographyApprovalForm 						,
ConfinedSpaceEntryTrackingLog 					,
FlareLineChecklists 							,
HotTurnoverApprovalForm 						,
IndustrialHygieneAreaRealTimeSamplingForm 		,
CraneSuspendedWorkPlatformChecklist 			,
ConfinedSpaceEntryAuthorizationFormSecondSection, 


    GasTestElements
)
VALUES
(
    @Id,
    @LastModifiedDate,
    @LastModifiedUserId,
    @ApprovedByUserId,
    @SourceId,

    @SpecialRescueOrFallNotApplicable,
    @SpecialRescueOrFallOtherDescription,
    @SpecialRescueOrFallRescueDevice,
    @SpecialRescueOrFallYoYo,
    @SpecialRescueOrFallLifeline,
    @SpecialRescueOrFallBodyHarness,
	
    @SpecialHandProtectionNotApplicable,
    @SpecialHandProtectionOtherDescription,
    @SpecialHandProtectionChemicalGloves,
    @SpecialHandProtectionLeather,
    @SpecialHandProtectionWelding,
    @SpecialHandProtectionHighVoltage,
    @SpecialHandProtectionPVC,
    @SpecialHandProtectionNitrile,
    @SpecialHandProtectionNaturalRubber,
    @SpecialHandProtectionChemicalNeprene,

    @SpecialProtectiveFootwearNotApplicable,
    @SpecialProtectiveFootwearOtherDescription,
    @SpecialProtectiveFootwearToeGuard,
    @SpecialProtectiveFootwearChemicalImperviousBoots,
    @SpecialProtectiveFootwearMetatarsalGuard,

    @SpecialProtectiveClothingTypeNotApplicable,
    @SpecialProtectiveClothingTypeOtherDescripton,    
    @SpecialProtectiveClothingTypeTyvekSuit,
	@SpecialProtectiveClothingTypeKapplerSuit,
	@SpecialProtectiveClothingTypeElectricalFlashGear,
	@SpecialProtectiveClothingTypeCorrosiveClothing,
    @SpecialProtectiveClothingTypeCausticWear,
	@SpecialProtectiveClothingTypePaperCoveralls,
    @SpecialProtectiveClothingTypeAcidClothingTypeID,
    @SpecialProtectiveClothingTypeAcidClothing,
    @SpecialProtectiveClothingTypeRainPants,
    @SpecialProtectiveClothingTypeRainCoat,

    @SpecialEyeOrFaceProtectionNotApplicable,
    @SpecialEyeOrFaceProtectionOtherDescription,
    @SpecialEyeOrFaceProtectionFaceshield,
    @SpecialEyeOrFaceProtectionGoggles,

    @RespitoryProtectionRequirementsNotApplicable,
    @RespitoryProtectionRequirementsRespiratoryCartridgeTypeDescription,
    @RespitoryProtectionRequirementsRespiratoryCartridgeTypeId,
    @RespitoryProtectionRequirementsOtherDescription,
    @RespitoryProtectionRequirementsAirHood,
    @RespitoryProtectionRequirementsDustMask,
    @RespitoryProtectionRequirementsFullFaceRespirator,
    @RespitoryProtectionRequirementsHalfFaceRespirator,
    @RespitoryProtectionRequirementsSCBA,
    @RespitoryProtectionRequirementsAirCartOrAirLine,

    @FireConfinedSpaceNotApplicable,
    @FireConfinedSpaceOtherDescription,
    @FireConfinedSpaceWatchmen,
    @FireConfinedSpaceHoleWatchNumber,
    @FireConfinedSpaceFireWatchNumber,
    @FireConfinedSpaceSpotterNumber,    
    @FireConfinedSpaceSteamHose,
    @FireConfinedSpaceWaterHose,
    @FireConfinedSpaceSparkContainment,
    @FireConfinedSpaceFireResistantTarp,
    @FireConfinedSpaceC02Extinguisher,
    @FireConfinedSpace20ABCorDryChemicalExtinguisher,

    @GasTestConstantMonitoringRequired,
    @GasTestTestTime,
    @GasTestConfinedSpaceTestTime,
    @GasTestSystemEntryTestTime,
    @GasTestFrequencyOrDuration,

    @RadiationSealedSourceIsolationNumberOfSources,
    @RadiationSealedSourceIsolationOpen,
    @RadiationSealedSourceIsolationLOTO,
    @RadiationSealedSourceIsolationNotApplicable,

    @JobSitePreparationLightingElectricalRequirementOtherDescription,
    @JobSitePreparationLightingElectricalRequirementGeneratorLights,
    @JobSitePreparationLightingElectricalRequirement110VWithGFCI,
    @JobSitePreparationLightingElectricalRequirementLowVoltage12V,
    @JobSitePreparationLightingElectricalRequirementNotApplicable,
    @JobSitePreparationAreaPreparationOtherDescription,
    @JobSitePreparationAreaPreparationPreopBoundaryRopeTape,
    @JobSitePreparationAreaPreparationRadiationRope,
    @JobSitePreparationAreaPreparationNonEssentialEvac,
    @JobSitePreparationAreaPreparationBarricade,
    @JobSitePreparationAreaPreparationNotApplicable,
    @JobSitePreparationVentilationMethodForced,
    @JobSitePreparationVentilationMethodLocalExhaust,
    @JobSitePreparationVentilationMethodNaturalDraft,
    @JobSitePreparationVentilationMethodNotApplicable,
    @JobSitePreparationSewerIsolationMethodOtherDescription,
    @JobSitePreparationSewerIsolationMethodBlindedOrBlanked,
    @JobSitePreparationSewerIsolationMethodPlugged,
    @JobSitePreparationSewerIsolationMethodSealedOrCovered,
    @JobSitePreparationSewerIsolationMethodNotApplicable,
    @JobSitePreparationPermitReceiverFieldOrEquipmentOrientation,
	@IsControlRoomContactedOrNot, --vibhor
	@Revalidation,
    @JobSitePreparationPermitReceiverFieldOrEquipmentOrientationNotApplicable,
    @JobSitePreparationVestedBuddySystemInEffect,
    @JobSitePreparationVestedBuddySystemInEffectNotApplicable,
    @JobSitePreparationSurroundingConditionsAffectOrContaminated,
    @JobSitePreparationSurroundingConditionsAffectOrContaminatedNotApplicable,
    @JobSitePreparationCriticalConditionRemainJobSite,
    @JobSitePreparationCriticalConditionRemainJobSiteNotApplicable,
    @JobSitePreparationWeldingGroundWireInTestArea,
    @JobSitePreparationWeldingGroundWireInTestAreaNotApplicable,
    @JobSitePreparationBondingOrGroundingRequired,
    @JobSitePreparationBondingOrGroundingRequiredNotApplicable,
	@ControlRoomContactedNotApplicable, --vibhor
    @JobSitePreparationFlowRequiredForJobNotApplicable,
    @JobSitePreparationFlowRequiredForJob,

    @EquipmentIsolationMethodOtherDescription,
    @EquipmentIsolationMethodLOTO,
    @EquipmentIsolationMethodMudderPlugs,
    @EquipmentIsolationMethodSeparation,
    @EquipmentIsolationMethodBlindedorBlanked,
    @EquipmentIsolationMethodBlockedIn,
    @EquipmentIsolationMethodCarBer,
    @EquipmentIsolationMethodNotApplicable,
    @EquipmentPreviousContentsOtherDescription,
    @EquipmentPreviousContentsH2S,
    @EquipmentPreviousContentsCaustic,
    @EquipmentPreviousContentsAcid,
    @EquipmentPreviousContentsHydrocarbon,
    @EquipmentPreviousContentsNotApplicable,
	@EquipmentAsbestosGasketsNotApplicable,
	@EquipmentAsbestosGaskets,
    @EquipmentConditionPurgedDescription,
    @EquipmentConditionPurged,    
    @EquipmentConditionPurgedN2,
    @EquipmentConditionPurgedSteamed,
    @EquipmentConditionPurgedAir,
    @EquipmentConditionNeutralized,
    @EquipmentConditionH20Washed,
    @EquipmentConditionVentilated,
    @EquipmentConditionCleaned,
    @EquipmentConditionDrained,
    @EquipmentConditionDepressured,
    @EquipmentConditionNotApplicable,
    @EquipmentConditionOtherDescription,
	@EquipmentConditionPurgedChecked, --vibhor
    @EquipmentIsOutOfService,
    @EquipmentLeakingValves,
    @EquipmentLeakingValvesNotApplicable,    
    @EquipmentStillContainsResidual,
    @EquipmentStillContainsResidualNotApplicable,

    @ElectricTestBump,
    @ElectricTestBumpNotApplicable,
    @ElectricIsolationMethodWiring,
    @ElectricIsolationMethodLOTO,
    @ElectricIsolationMethodNotApplicable,

    @EquipmentIsHazardousEnergyIsolationRequiredNotApplicable,
    @EquipmentIsHazardousEnergyIsolationRequired,
    @EquipmentLockOutMethodId,
    @EquipmentLockOutMethodComments,
    @EquipmentEnergyIsolationPlanNumber,
    @EquipmentConditionsOfEIPSatisfied,
    @EquipmentConditionsOfEIPNotSatisfiedComments,

    @AsbestosHazardsConsideredNotApplicable,
    @AsbestosHazardsConsidered,

    @ToolsOtherToolsDescription,
    @ToolsWelder,
    @ToolsChemicals,
    @ToolsTorch,
    @ToolsPortLighting,
    @ToolsHotTapMachine,
    @ToolsTamper,
    @ToolsManlift,
    @ToolsHEPAVacuum,
    @ToolsForklift,
    @ToolsCompressor,
    @ToolsVehicle,
    @ToolsScaffolding,
    @ToolsLanda,
    @ToolsHeavyEquipment,
    @ToolsElectricTools,
    @ToolsCementSaw,
    @ToolsVacuumTruck,
    @ToolsJackhammer,
    @ToolsHandTools,
    @ToolsCraneOrCarrydeck,
    @ToolsAirTools,

    @CoAuthorizationDescription,
    @CoAuthorizationRequired,
    @CommunicationByOtherDescription,
    @CommunicationRadioColor,
    @CommunicationRadioChannelOrBand,
    @IsWorkPermitCommunicationNotApplicable,
    @CommunicationByRadio,
    @JobStepDescription,
    @CraftOrTradeOther,
    @CraftOrTradeID,
    @ContractorCompanyName,
    @ContactPersonnel,

    @AdditionalOtherFormsOrAssessmentsOrAuthorizations,
    @AdditionalMSDS,
    @AdditionalWaiverOrDeviation,
    @AdditionalWaiverOrDeviationDescription,
    @AdditionalBurnOrOpenFlameAssessment,
    @AdditionalBurnOrOpenFlameAssessmentDescription,
    @AdditionalElectrical,
    @AdditionalElectricalDescription,
    @AdditionalRoadClosure,
    @AdditionalAsbestosHandling,
    @AdditionalAsbestosHandlingDescription,
    @AdditionalPJSROrSafetyPause,
    @AdditionalBlankOrBlindLists,
    @AdditionalSpecialWasteDisposal,
    @AdditionalHotTap,
    @AdditionalExcavation,
    @AdditionalExcavationDescription,
    @AdditionalCriticalLift,
    @AdditionalCriticalLiftDescription,
    @AdditionalFlareEntry,
    @AdditionalCSEAssessmentOrAuthorization,
    @AdditionalCSEAssessmentOrAuthorizationDescription,
    @AdditionalRadiationApproval,
    @AdditionalOnlineLeakRepairForm,

    @PermitRadiationSealed,
    @PermitRadiationRadiography,
    @PermitAsbestos,
    @PermitExcavation,
    @PermitCriticalLift,
    @PermitSystemEntry,
	@PermitFreshAir, --vibhor
	@ControlRoomContacted, --vibhor
    @PermitBurnOrOpenFlame,
    @PermitHotTap,
    @PermitVehicleEntry,
    @PermitElectricalWork,
    @PermitBreathingAirOrSCBA,
    @PermitConfinedSpaceEntry,
    @PermitInertConfinedSpaceEntry,
    @PermitLeadAbatement,

    @SpecialPrecautionsOrConsiderationsDescription,
    @WorkOrderDescription,
    @WorkPermitTypeClassificationId,
    @WorkPermitTypeId,
    @PermitValidDateTime,
    @EndDateTime,
    @StartDateTime,
    @StartAndOrEndTimesFinalized,
    @WorkOrderNumber,
    @PermitNumber,
    @FunctionalLocationId,
	@WorkAssignmentId,
    @WorkPermitStatusId,
    @EquipmentStillContainsResidualComments,
    @EquipmentInServiceComments,
    @EquipmentNoElectricalTestBumpComments,
    @EquipmentLeakingValvesComments,
    @JobSitePreparationFlowRequiredComments,
    @JobSitePreparationBondingGroundingNotRequiredComments,
	@EquipmentInAsbestosHazardPresentComments, --vibhor
	
    @JobSitePreparationWeldingGroundWireNotWithinGasTestAreaComments,
    @JobSitePreparationSurroundingConditionsAffectAreaComments,
    @JobSitePreparationPermitReceiverRequiresOrientationComments,
    @JobSitePreparationCriticalConditionsComments,    
    @SapOperationId,
    @DocumentLinks,

	@PreExcavationAuthorization							,
@SuspendedWorkPlatform 								,
@HotTurnoverApproval 								,
@ConfinedSpaceEntryAuthorizationForm 				,
@PreExcavationAuthorizationForm 					,
@SupplementalJobSiteSignInForm 						,
@SystemEntryGasTestLogFrom 							,
@HeatStressMonitoringForm 							,
@CriticalLiftApprovalForm 							,
@PjsrSecondSection 									,
@DeviationRequestForm 								,
@RoadClosureform 									,
@RadiographyApprovalForm 							,
@ConfinedSpaceEntryTrackingLog 						,
@FlareLineChecklists 								,
@HotTurnoverApprovalForm 							,
@IndustrialHygieneAreaRealTimeSamplingForm 			,
@CraneSuspendedWorkPlatformChecklist 				,
@ConfinedSpaceEntryAuthorizationFormSecondSection 	,


    @GasTestElements
);

INSERT INTO WorkPermitHistory_Extension
(
    Id,
	LastModifiedDate,
	
	SpecialFallOtherDescription,
	SpecialFallRestraint,
	SpecialFallSelfRetractingDevice,
	SpecialFallTieoffRequired,
	
	GasTestForkliftNotUsed,
	AdditionalIsEnergizedElectricalForm,
	AdditionalIsNotApplicable,
	
	StartTimeNotApplicable
)
VALUES
(
	@Id,
	@LastModifiedDate,
	
	@SpecialFallOtherDescription,
	@SpecialFallRestraint,
	@SpecialFallSelfRetractingDevice,
	@SpecialFallTieoffRequired,
	
	@GasTestForkliftNotUsed,
	@AdditionalIsEnergizedElectricalForm,
	@AdditionalIsNotApplicable,
	
	@StartTimeNotApplicable
);



GO

GRANT EXEC ON InsertWorkPermitHistory TO PUBLIC
GO
