
INSERT INTO dbo.SiteFunctionalArea (SiteId,FunctionalArea) VALUES (10,6)  -- lubes / work permits

INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Administrator' and re.[Name] = 'View Permit';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Administrator' and re.[Name] = 'View Permit Requests';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Administrator' and re.[Name] = 'Configure Work Permit Dropdowns';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Area Team Lead' and re.[Name] = 'View Permit';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Area Team Lead' and re.[Name] = 'View Permit Requests';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Engineering' and re.[Name] = 'View Permit';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Engineering' and re.[Name] = 'View Permit Requests';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Lead Technician' and re.[Name] = 'View Permit';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Lead Technician' and re.[Name] = 'Create Permit';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Lead Technician' and re.[Name] = 'Delete Permit';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Lead Technician' and re.[Name] = 'Update Permit at any time';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Lead Technician' and re.[Name] = 'Print Permit';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Lead Technician' and re.[Name] = 'Clone work permit with no restriction';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Lead Technician' and re.[Name] = 'Close Permit';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Maintenance Coordinator' and re.[Name] = 'View Action Item';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Maintenance Coordinator' and re.[Name] = 'View Log';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Maintenance Coordinator' and re.[Name] = 'View Directives';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Maintenance Coordinator' and re.[Name] = 'View Summary Logs';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Maintenance Coordinator' and re.[Name] = 'View Shift Handover';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Maintenance Coordinator' and re.[Name] = 'View Permit';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Maintenance Coordinator' and re.[Name] = 'View Permit Requests';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Maintenance Coordinator' and re.[Name] = 'Comment WorkPermit';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Maintenance Coordinator' and re.[Name] = 'Create Permit Request';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Maintenance Coordinator' and re.[Name] = 'Edit Permit Request';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Maintenance Coordinator' and re.[Name] = 'Delete Permit Request';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Maintenance Coordinator' and re.[Name] = 'Submit Permit Request';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Maintenance Coordinator' and re.[Name] = 'Import Permit Requests';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Maintenance Coordinator' and re.[Name] = 'Clone Permit Request';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Operations Coordinator' and re.[Name] = 'View Permit';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Operations Coordinator' and re.[Name] = 'View Permit Requests';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Operations Coordinator' and re.[Name] = 'Comment WorkPermit';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Operations Coordinator' and re.[Name] = 'Create Permit Request';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Operations Coordinator' and re.[Name] = 'Edit Permit Request';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Operations Coordinator' and re.[Name] = 'Delete Permit Request';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Operations Coordinator' and re.[Name] = 'Submit Permit Request';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Operations Coordinator' and re.[Name] = 'Import Permit Requests';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Operations Coordinator' and re.[Name] = 'Clone Permit Request';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Operator' and re.[Name] = 'View Permit';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Operator' and re.[Name] = 'View Permit Requests';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Operator' and re.[Name] = 'Create Permit';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Operator' and re.[Name] = 'Delete Permit';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Operator' and re.[Name] = 'Update Permit at any time';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Operator' and re.[Name] = 'Clone work permit with no restriction';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Operator' and re.[Name] = 'Close Permit';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Read User' and re.[Name] = 'View Permit';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Read User' and re.[Name] = 'View Permit Requests';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Scheduler' and re.[Name] = 'View Action Item';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Scheduler' and re.[Name] = 'View Log';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Scheduler' and re.[Name] = 'View Directives';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Scheduler' and re.[Name] = 'View Summary Logs';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Scheduler' and re.[Name] = 'View Shift Handover';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Scheduler' and re.[Name] = 'View Permit';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Scheduler' and re.[Name] = 'View Permit Requests';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Scheduler' and re.[Name] = 'Submit Permit Request';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Scheduler' and re.[Name] = 'Import Permit Requests';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Supervisor' and re.[Name] = 'View Permit';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Supervisor' and re.[Name] = 'Create Permit';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Supervisor' and re.[Name] = 'Update Permit at any time';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Supervisor' and re.[Name] = 'Delete Permit';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Supervisor' and re.[Name] = 'Print Permit';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Supervisor' and re.[Name] = 'Clone work permit with no restriction';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Supervisor' and re.[Name] = 'Close Permit';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Supervisor' and re.[Name] = 'Comment WorkPermit';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Supervisor' and re.[Name] = 'View Permit Requests';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Supervisor' and re.[Name] = 'Create Permit Request';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Supervisor' and re.[Name] = 'Edit Permit Request';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Supervisor' and re.[Name] = 'Delete Permit Request';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Supervisor' and re.[Name] = 'Submit Permit Request';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Supervisor' and re.[Name] = 'Import Permit Requests';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Supervisor' and re.[Name] = 'Clone Permit Request';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Technical Administrator' and re.[Name] = 'View Permit';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Technical Administrator' and re.[Name] = 'View Permit Requests';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Trade Supervisor' and re.[Name] = 'View Action Item';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Trade Supervisor' and re.[Name] = 'View Log';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Trade Supervisor' and re.[Name] = 'View Directives';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Trade Supervisor' and re.[Name] = 'View Summary Logs';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Trade Supervisor' and re.[Name] = 'View Shift Handover';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Trade Supervisor' and re.[Name] = 'View Permit';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Trade Supervisor' and re.[Name] = 'View Permit Requests';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Trade Supervisor' and re.[Name] = 'Comment WorkPermit';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Trade Supervisor' and re.[Name] = 'Create Permit Request';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Trade Supervisor' and re.[Name] = 'Edit Permit Request';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Trade Supervisor' and re.[Name] = 'Delete Permit Request';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Trade Supervisor' and re.[Name] = 'Submit Permit Request';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Trade Supervisor' and re.[Name] = 'Clone Permit Request';

INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Maintenance Supervisor' and re.[Name] = 'View Permit';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Maintenance Supervisor' and re.[Name] = 'View Permit Requests';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Maintenance Tech' and re.[Name] = 'View Permit';
INSERT INTO RoleElementTemplate (RoleElementId, RoleId) select re.Id, r.Id from RoleElement re, Role r where r.SiteId = 10 and r.[Name] = 'Maintenance Tech' and re.[Name] = 'View Permit Requests';


GO

update SiteConfiguration set ShowWorkPermitsOnPriorityPage = 1 where SiteId in (10);


GO




GO




insert into RoleElement (Id, Name, FunctionalArea) values (210, 'View Navigation - Action Items', 'Action Items');
insert into RoleElement (Id, Name, FunctionalArea) values (211, 'View Navigation - Targets', 'Targets');
insert into RoleElement (Id, Name, FunctionalArea) values (212, 'View Navigation - Logs', 'Logs');
insert into RoleElement (Id, Name, FunctionalArea) values (213, 'View Navigation - Work Permits', 'Work Permits');
insert into RoleElement (Id, Name, FunctionalArea) values (214, 'View Navigation - Shift Handovers', 'Shift Handovers');
insert into RoleElement (Id, Name, FunctionalArea) values (215, 'View Navigation - Lab Alerts', 'Lab Alerts');
insert into RoleElement (Id, Name, FunctionalArea) values (216, 'View Navigation - Restrictions', 'Restriction Reporting');
insert into RoleElement (Id, Name, FunctionalArea) values (217, 'View Navigation - Forms', 'Forms');

insert into RoleElement (Id, Name, FunctionalArea) values (218, 'View Priorities - Action Items', 'Action Items');
insert into RoleElement (Id, Name, FunctionalArea) values (219, 'View Priorities - Targets', 'Targets');
insert into RoleElement (Id, Name, FunctionalArea) values (220, 'View Priorities - Directives', 'Logs');
insert into RoleElement (Id, Name, FunctionalArea) values (221, 'View Priorities - Forms', 'Forms');
insert into RoleElement (Id, Name, FunctionalArea) values (222, 'View Priorities - Form OP-14s', 'Forms');
insert into RoleElement (Id, Name, FunctionalArea) values (223, 'View Priorities - Shift Handovers', 'Shift Handovers');
insert into RoleElement (Id, Name, FunctionalArea) values (224, 'View Priorities - Work Permits', 'Work Permits');

go

insert into RoleElementTemplate (RoleElementId, RoleId)
select re.Id, r.Id
from RoleElement re,
     Role r
where re.Name = 'View Navigation - Action Items' and
      r.SiteId in (select sfa.SiteId from SiteFunctionalArea sfa where sfa.FunctionalArea = 1)

insert into RoleElementTemplate (RoleElementId, RoleId)
select re.Id, r.Id
from RoleElement re,
     Role r
where re.Name = 'View Navigation - Targets' and
      r.SiteId in (select sfa.SiteId from SiteFunctionalArea sfa where sfa.FunctionalArea = 2) and
	  r.Id in (select ret.RoleId from RoleElementTemplate ret where ret.RoleElementId in (select re2.Id from RoleElement re2 where re2.Name = 'View Target Definition'))

insert into RoleElementTemplate (RoleElementId, RoleId)
select re.Id, r.Id
from RoleElement re,
     Role r
where re.Name = 'View Navigation - Logs' and
      r.SiteId in (select sfa.SiteId from SiteFunctionalArea sfa where sfa.FunctionalArea in (3, 4, 5, 10, 11))

insert into RoleElementTemplate (RoleElementId, RoleId)
select re.Id, r.Id
from RoleElement re,
     Role r
where re.Name = 'View Navigation - Work Permits' and
      r.SiteId in (select sfa.SiteId from SiteFunctionalArea sfa where sfa.FunctionalArea = 6)
	  
insert into RoleElementTemplate (RoleElementId, RoleId)
select re.Id, r.Id
from RoleElement re,
     Role r
where re.Name = 'View Navigation - Shift Handovers' and
      r.SiteId in (select sfa.SiteId from SiteFunctionalArea sfa where sfa.FunctionalArea = 7)

insert into RoleElementTemplate (RoleElementId, RoleId)
select re.Id, r.Id
from RoleElement re,
     Role r
where re.Name = 'View Navigation - Lab Alerts' and
      r.SiteId in (select sfa.SiteId from SiteFunctionalArea sfa where sfa.FunctionalArea = 9)

insert into RoleElementTemplate (RoleElementId, RoleId)
select re.Id, r.Id
from RoleElement re,
     Role r
where re.Name = 'View Navigation - Restrictions' and
      r.SiteId in (select sfa.SiteId from SiteFunctionalArea sfa where sfa.FunctionalArea = 8)

insert into RoleElementTemplate (RoleElementId, RoleId)
select re.Id, r.Id
from RoleElement re,
     Role r
where re.Name = 'View Navigation - Forms' and
      r.SiteId in (select sfa.SiteId from SiteFunctionalArea sfa where sfa.FunctionalArea = 12)

	  
go


----------------------------------------------------------------------------------------------------------


insert into RoleElementTemplate (RoleElementId, RoleId)
select re.Id, r.Id
from RoleElement re,
     Role r
where re.Name = 'View Priorities - Action Items' and
      r.SiteId in (select sfa.SiteId from SiteFunctionalArea sfa where sfa.FunctionalArea = 1) and
	  r.Id in (select ret.RoleId from RoleElementTemplate ret where ret.RoleElementId in (select re2.Id from RoleElement re2 where re2.Name = 'View Action Item'))

insert into RoleElementTemplate (RoleElementId, RoleId)
select re.Id, r.Id
from RoleElement re,
     Role r
where re.Name = 'View Priorities - Targets' and
      r.SiteId in (select sfa.SiteId from SiteFunctionalArea sfa where sfa.FunctionalArea = 2) and
	  r.Id in (select ret.RoleId from RoleElementTemplate ret where ret.RoleElementId in (select re2.Id from RoleElement re2 where re2.Name = 'View Target Definition'))
	  
insert into RoleElementTemplate (RoleElementId, RoleId)
select re.Id, r.Id
from RoleElement re,
     Role r
where re.Name = 'View Priorities - Directives' and
      r.SiteId in (select sfa.SiteId from SiteFunctionalArea sfa where sfa.FunctionalArea = 5) and
	  r.SiteId in (select sc.SiteId from SiteConfiguration sc where sc.ShowDirectivesOnPriorityPage = 1) and
	  r.Id in (select ret.RoleId from RoleElementTemplate ret where ret.RoleElementId in (select re2.Id from RoleElement re2 where re2.Name = 'View Directives'))

insert into RoleElementTemplate (RoleElementId, RoleId)
select re.Id, r.Id
from RoleElement re,
     Role r
where re.Name = 'View Priorities - Forms' and
      r.SiteId in (select sfa.SiteId from SiteFunctionalArea sfa where sfa.FunctionalArea = 12) and
	  r.Id in (select ret.RoleId from RoleElementTemplate ret where ret.RoleElementId in (select re2.Id from RoleElement re2 where re2.Name = 'View Form'))

insert into RoleElementTemplate (RoleElementId, RoleId)
select re.Id, r.Id
from RoleElement re,
     Role r
where re.Name = 'View Priorities - Form OP-14s' and
      r.SiteId in (select sfa.SiteId from SiteFunctionalArea sfa where sfa.FunctionalArea = 12) and
	  r.SiteId in (select sc.SiteId from SiteConfiguration sc where sc.ShowActiveCriticalSystemDefeatsOnPriorityPage = 1) and
	  r.Id in (select ret.RoleId from RoleElementTemplate ret where ret.RoleElementId in (select re2.Id from RoleElement re2 where re2.Name = 'View Form'))

insert into RoleElementTemplate (RoleElementId, RoleId)
select re.Id, r.Id
from RoleElement re,
     Role r
where re.Name = 'View Priorities - Shift Handovers' and
      r.SiteId in (select sfa.SiteId from SiteFunctionalArea sfa where sfa.FunctionalArea = 7) and
	  (
	    r.SiteId in (select sc.SiteId from SiteConfiguration sc where sc.UseNewPriorityPage = 0)
		or
		r.SiteId in (select sc.SiteId from SiteConfiguration sc where sc.ShowShiftHandoversOnPriorityPage = 1)
	  ) and
	  r.Id in (select ret.RoleId from RoleElementTemplate ret where ret.RoleElementId in (select re2.Id from RoleElement re2 where re2.Name = 'View Shift Handover'))

insert into RoleElementTemplate (RoleElementId, RoleId)
select re.Id, r.Id
from RoleElement re,
     Role r
where re.Name = 'View Priorities - Work Permits' and
      r.SiteId in (select sfa.SiteId from SiteFunctionalArea sfa where sfa.FunctionalArea = 6) and
	  (
	  	r.SiteId in (select sc.SiteId from SiteConfiguration sc where sc.UseNewPriorityPage = 0)
		or
		r.SiteId in (select sc.SiteId from SiteConfiguration sc where sc.ShowWorkPermitsOnPriorityPage = 1)
	  ) and
	  r.Id in (select ret.RoleId from RoleElementTemplate ret where ret.RoleElementId in (select re2.Id from RoleElement re2 where re2.Name = 'View Permit'))
	  
go


alter table SiteConfiguration drop column ShowShiftHandoversOnPriorityPage;
alter table SiteConfiguration drop column ShowActiveCriticalSystemDefeatsOnPriorityPage;
alter table SiteConfiguration drop column ShowDirectivesOnPriorityPage;

go

drop table SiteFunctionalArea;

go

















GO

CREATE NONCLUSTERED INDEX [IDX_Schedule_EndDateTime]
ON [dbo].[Schedule]
([EndDateTime], [StartDateTime])
INCLUDE ([Id])
WITH
(
PAD_INDEX = OFF,
FILLFACTOR = 90,
IGNORE_DUP_KEY = OFF,
STATISTICS_NORECOMPUTE = OFF,
ONLINE = OFF,
ALLOW_ROW_LOCKS = ON,
ALLOW_PAGE_LOCKS = ON,
DATA_COMPRESSION = NONE
)
ON [PRIMARY];
GO

CREATE NONCLUSTERED INDEX [IDX_TagName_SiteAndName]
ON [dbo].[Tag]
([SiteId] , [Name] , [Deleted])
INCLUDE ([Units], [Id], [Description])
WITH
(
PAD_INDEX = OFF,
FILLFACTOR = 90,
IGNORE_DUP_KEY = OFF,
STATISTICS_NORECOMPUTE = OFF,
ONLINE = OFF,
ALLOW_ROW_LOCKS = ON,
ALLOW_PAGE_LOCKS = ON,
DATA_COMPRESSION = NONE,
DROP_EXISTING = ON
)
ON [PRIMARY];
GO

CREATE NONCLUSTERED INDEX [IDX_ActionItemDefinition_WorkAssignmentId]
ON [dbo].[ActionItemDefinition]
([WorkAssignmentId] , [Deleted] , [Active])
INCLUDE ([Id], [ScheduleId])
WITH
(
PAD_INDEX = OFF,
FILLFACTOR = 100,
IGNORE_DUP_KEY = OFF,
STATISTICS_NORECOMPUTE = OFF,
ONLINE = OFF,
ALLOW_ROW_LOCKS = ON,
ALLOW_PAGE_LOCKS = ON,
DATA_COMPRESSION = NONE,
DROP_EXISTING = ON
)
ON [PRIMARY];
GO


GO

